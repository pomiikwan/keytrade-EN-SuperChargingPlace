
<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="库里蓝暗夜主题.css">

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Business Plan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            line-height: 1.6;
            color: #FFFFFF !important;
            background: #0A0E27;
            padding: 20px;
        }

        /* Normal page layout - Cancel A4 page division */
        .page-container {
            display: block;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page {
            width: 100%;
            background: rgba(26, 35, 71, 0.95);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px;
            margin: 0 0 30px 0;
            position: relative;
        }

        .page:last-child {
            margin-bottom: 0;
            page-break-after: auto;
        }

        /* A4 page content container */
        .page-content {
            height: 100%;
            overflow: hidden; /* Single page mode no scrolling */
            position: relative;
        }

        /* A4 page size indicator */
        .page::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 56px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            z-index: 1;
        }

        /* Page number display */
        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: normal;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #FFC72C;
            padding-bottom: 20px;
        }

        .title {
            font-size: 32px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 18px;
            color: #B8C5E0 !important;
            margin-bottom: 5px;
        }

        .meta {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        .section {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            border-left: 5px solid #FFC72C;
            padding-left: 15px;
        }

        .subsection-title {
            font-size: 18px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin: 15px 0 10px 0;
        }

        .highlight-box {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-align: center;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: #FFC72C;
            background: rgba(255, 255, 255, 0.12);
        }

        .data-value {
            font-size: 24px;
            font-weight: bold;
            color: #FFC72C !important;
            margin-bottom: 5px;
        }

        .data-label {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px;
            text-align: left;
        }

        th {
            background: rgba(255, 199, 44, 0.2);
            font-weight: bold;
            color: #FFFFFF !important;
        }

        td {
            color: #B8C5E0 !important;
        }

        .highlight-row {
            background: rgba(255, 199, 44, 0.15);
            font-weight: bold;
        }

        .highlight-row td {
            color: #FFFFFF !important;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        li {
            margin-bottom: 5px;
            color: #B8C5E0 !important;
        }

        .conclusion {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .conclusion-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .contact {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        .page-break {
            page-break-before: always;
        }

        .chart-placeholder {
            background: #f3f4f6;
            border: 2px dashed #9ca3af;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            color: #6b7280;
            margin: 20px 0;
        }

        @media print {
            .page {
                box-shadow: none;
                margin: 0;
            }
        }

        /* Chart and image styles */
        .chart-container {
            margin: 20px 0;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            page-break-inside: avoid;
            max-width: 100%;
            overflow: hidden;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-container canvas {
            max-width: 100%;
            height: auto !important;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            display: block;
            margin: 0 auto;
        }

        .image-container {
            margin: 25px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            page-break-inside: avoid;
        }

        .image-title {
            font-size: 16px;
            font-weight: 600;
            color: #FFFFFF !important;
            margin-bottom: 12px;
            text-align: center;
        }

        .image-wrapper {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .content-image {
            max-width: 100%;
            height: auto;
            border-radius: 6px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .image-caption {
            font-size: 14px;
            color: #B8C5E0 !important;
            margin-top: 10px;
            font-style: italic;
            line-height: 1.4;
        }

        .tech-images-grid {
            display: grid;
            grid-template-columns: 1fr; /* Single page mode changed to single column */
            gap: 25px;
            margin: 20px 0;
        }

        @media (max-width: 1200px) {
            .tech-images-grid {
                grid-template-columns: 1fr;
            }
        }

    
        /* Responsive design - A4 page single-page adaptive layout */
        @media (max-width: 1200px) {
            .page-container {
                max-width: 500px;
                padding: 15px;
            }

            .page {
                max-width: 100%;
                min-height: 708px; /* Maintain A4 ratio */
                padding: 35px 25px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding: 10px;
                background: #0A0E27;
            }

            .page-container {
                padding: 10px;
                max-width: 100%;
            }

            .page {
                padding: 25px 20px;
                margin: 0 auto 20px;
                min-height: auto;
                min-height: 600px; /* Moderate height for mobile */
                border-radius: 15px;
            }

            .page-content {
                overflow: visible; /* Allow normal content display on mobile */
            }

            .page::before {
                display: none; /* Hide A4 indicator on mobile */
            }

            .page-number {
                bottom: 10px;
                right: 15px;
            }

            .page-break {
                page-break-before: auto;
                margin-top: 30px;
                border-top: 2px solid rgba(255, 199, 44, 0.3);
                padding-top: 30px;
            }

            .title {
                font-size: 24px;
            }

            .section-title {
                font-size: 20px;
            }

            .data-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .tech-images-grid {
                grid-template-columns: 1fr;
            }

            .charts-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            /* PDF export button mobile adaptation */
            .pdf-export-section {
                bottom: 20px;
                right: 20px;
            }

            .pdf-export-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        /* Extra small screen adaptation */
        @media (max-width: 480px) {
            .page-container {
                padding: 5px;
            }

            .page {
                padding: 20px 15px;
                margin: 0 auto 15px;
                min-height: 500px;
                border-radius: 10px;
            }

            .title {
                font-size: 20px;
            }

            .section-title {
                font-size: 18px;
            }

            .data-grid {
                grid-template-columns: 1fr;
            }

            .header {
                margin-bottom: 20px;
            }

            .pdf-export-section {
                bottom: 15px;
                right: 15px;
            }

            .pdf-export-btn {
                padding: 10px 15px;
                font-size: 13px;
                box-shadow: 0 5px 15px rgba(29, 66, 138, 0.3);
            }
        }

        /* Large screen single-page adaptation */
        @media (min-width: 1400px) {
            .page-container {
                max-width: 650px;
                padding: 30px;
            }

            .page {
                max-width: 100%;
                min-height: 918px; /* Maintain A4 ratio */
                padding: 45px 35px;
            }
        }

        /* Extra large screen single-page adaptation */
        @media (min-width: 1800px) {
            .page-container {
                max-width: 700px;
                padding: 40px;
            }

            .page {
                max-width: 100%;
                min-height: 988px; /* Maintain A4 ratio */
                padding: 50px 40px;
            }
        }

        /* PDF export button styles */
        .pdf-export-section {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .pdf-export-btn {
            background: linear-gradient(135deg, #1D428A 0%, #0077C0 100%);
            color: #FFFFFF;
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 25px rgba(29, 66, 138, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .pdf-export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(29, 66, 138, 0.4);
            background: linear-gradient(135deg, #0077C0 0%, #1D428A 100%);
        }

        .pdf-export-btn:active {
            transform: translateY(0);
        }

        /* Hide PDF export button on mobile */
        @media (max-width: 768px) {
            .pdf-export-section {
                bottom: 20px;
                right: 20px;
            }

            .pdf-export-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }

        /* Print style optimization - Single page mode */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .page-container {
                display: block !important;
                max-width: none;
                padding: 0;
            }

            .page {
                width: 210mm;
                min-height: 297mm;
                max-width: none;
                margin: 0;
                padding: 15mm;
                background: white;
                box-shadow: none;
                border: none;
                border-radius: 0;
                page-break-after: always;
                overflow: hidden;
            }

            .page:last-child {
                page-break-after: auto;
            }

            .page-content {
                overflow: hidden;
            }

            .page-number {
                color: #666 !important;
            }

            .chart-container, .image-container {
                background: white;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .chart-title, .image-title {
                color: #1D428A !important;
            }

            .section {
                page-break-inside: avoid;
            }

            canvas {
                max-height: 300px !important;
            }

            .content-image {
                max-height: 400px !important;
            }

            .pdf-export-section {
                display: none !important;
            }

            /* Show all pages when printing */
            .page {
                display: block !important;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="page">
            <div class="page-content">
            <!-- Title Page -->
            <div class="header">
                <h1 class="title">Thousand-Station Liquid-Cooled Ultra-Fast Charging Project</h1>
                <h2 class="subtitle">Business Plan</h2>
            </div>

            <!-- Project Overview -->
            <div class="section">
                <h3 class="section-title">1. Project Overview</h3>

                <h4 class="subsection-title">1.1 Project Introduction</h4>
                <p>The Thousand-Station Liquid-Cooled Ultra-Fast Charging Project plans to build 1000 Huawei liquid-cooled ultra-fast charging stations within 5 years, with a total investment of 2.8 billion RMB. The project adopts Huawei's leading full liquid-cooled ultra-fast charging technology, achieving "1km per second" charging speed, providing an ultimate charging experience for new energy vehicle owners.</p>

                <div class="highlight-box">
                    <h4 class="highlight-title">Core Investment Highlights</h4>
                    <ul>
                        <li><strong>Technical Leadership</strong>: Huawei's full liquid-cooled ultra-fast charging technology, industry-leading power density</li>
                        <li><strong>Massive Market</strong>: China's charging pile market annual compound growth rate of 35%</li>
                        <li><strong>Investment Security</strong>: Multiple exit mechanisms, controllable risk</li>
                        <li><strong>Generous Returns</strong>: 10-year investment return rate of 435%, annualized return rate of 42.8%</li>
                    </ul>
                </div>

                <h4 class="subsection-title">1.2 Core Data</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">2.8 Billion RMB</div>
                        <div class="data-label">Total Investment</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">1000 Stations</div>
                        <div class="data-label">Number of Charging Stations</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">7200kW</div>
                        <div class="data-label">Single Station Power</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">4.5 Years</div>
                        <div class="data-label">Investment Payback Period</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">42.8%</div>
                        <div class="data-label">Project IRR</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">600kW</div>
                        <div class="data-label">Single Gun Power</div>
                    </div>
                </div>
            </div>

            <!-- Market Analysis -->
            <div class="section">
                <h3 class="section-title">2. Market Analysis</h3>

                <h4 class="subsection-title">2.1 Industry Background</h4>
                <p>China's new energy vehicle industry is in a period of explosive growth. In 2023, China's new energy vehicle sales reached 9.5 million units, with a penetration rate exceeding 35%. It is expected that by 2028, China's electric vehicle ownership will reach 70 million units, and charging pile demand will exceed 38 million.</p>

                <div class="chart-container">
                    <h4 class="chart-title">New Energy Vehicle Market Growth Trend</h4>
                    <canvas id="investorMarketGrowthChart" width="500" height="280"></canvas>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Charging Pile Market Size Forecast</h4>
                    <canvas id="investorMarketSizeChart" width="500" height="280"></canvas>
                </div>

                <h4 class="subsection-title">2.2 Market Size</h4>
                <ul>
                    <li><strong>Global Charging Pile Market</strong>: Expected to reach $125.39 billion by 2030</li>
                    <li><strong>China Market Size</strong>: Accounting for 67.4% of global market share</li>
                    <li><strong>Annual Compound Growth Rate</strong>: 35%</li>
                    <li><strong>Ultra-Fast Charging Market</strong>: Growing from 12 billion RMB in 2023 to 80 billion RMB in 2028</li>
                </ul>

                <h4 class="subsection-title">2.3 Competitive Analysis</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Competitors</th>
                            <th>Technical Features</th>
                            <th>Market Share</th>
                            <th>Power Level</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TELD</td>
                            <td>Group management and control technology</td>
                            <td>35%</td>
                            <td>480kW</td>
                        </tr>
                        <tr>
                            <td>Star Charge</td>
                            <td>Internet operation</td>
                            <td>30%</td>
                            <td>480kW</td>
                        </tr>
                        <tr>
                            <td>State Grid</td>
                            <td>Grid resource advantages</td>
                            <td>15%</td>
                            <td>360kW</td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>Huawei Liquid-Cooled Ultra-Fast Charging</strong></td>
                            <td><strong>Liquid cooling technology leadership</strong></td>
                            <td><strong>Target 10%</strong></td>
                            <td><strong>600kW</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Technical Solution -->
            <div class="section">
                <h3 class="section-title">3. Technical Solution</h3>

                <h4 class="subsection-title">3.1 Huawei Liquid-Cooled Ultra-Fast Charging Technology</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Technical Indicators</th>
                            <th>Huawei Liquid-Cooled Ultra-Fast Charging</th>
                            <th>Traditional Charging Piles</th>
                            <th>Improvement</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Maximum Power</td>
                            <td>600kW</td>
                            <td>120-180kW</td>
                            <td>3.3-5x</td>
                        </tr>
                        <tr>
                            <td>Charging Speed</td>
                            <td>"1km per second"</td>
                            <td>"1km per minute"</td>
                            <td>60x</td>
                        </tr>
                        <tr>
                            <td>Cooling Efficiency</td>
                            <td>300W/°C</td>
                            <td>100W/°C</td>
                            <td>3x</td>
                        </tr>
                        <tr>
                            <td>Equipment Noise</td>
                            <td>&lt;60dB</td>
                            <td>75dB</td>
                            <td>20% reduction</td>
                        </tr>
                        <tr>
                            <td>Service Life</td>
                            <td>15 years</td>
                            <td>8-10 years</td>
                            <td>1.5-1.9x</td>
                        </tr>
                        <tr>
                            <td>Conversion Efficiency</td>
                            <td>&gt;96%</td>
                            <td>93-95%</td>
                            <td>1-3%</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            </div>
        </div>

        <div class="page page-break">
            <div class="page-content">
            <!-- Continue Technical Solution -->
            <div class="section">
                <h3 class="section-title">3. Technical Solution (Cont.)</h3>

                <h4 class="subsection-title">3.2 System Architecture Diagram</h4>

                <p>The thousand-station liquid-cooled ultra-fast charging system adopts Huawei's leading full liquid-cooled ultra-fast charging technology, constructing a three-layer architecture design that achieves the ultimate charging experience of "1km per second". The system integrates a cloud management platform, station control system, and charging device layer, ensuring efficient, safe, and stable operational services.</p>

                <div class="chart-container">
                    <h4 class="chart-title">Overall System Architecture</h4>
                    <canvas id="systemArchitectureChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>Three-layer architecture design:</strong> Cloud management platform is responsible for big data analysis, intelligent scheduling, and remote monitoring; station control system implements local device management, power distribution, and safety protection; charging device layer provides 600kW high-power charging output, supporting liquid-cooling heat dissipation and intelligent diagnostics. All layers are interconnected through high-speed communication networks, ensuring real-time response and efficient collaboration.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Power System Architecture</h4>
                    <canvas id="powerSystemChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>Intelligent Power Distribution:</strong> Adopts 10kV dual-circuit power supply, configured with 2000kVA transformer, dynamically adjusting each charging pile output through intelligent power distribution modules. The system supports smart grid functions such as peak shaving and demand response, ensuring grid stability while maximizing charging efficiency. Power factor ≥0.99, total harmonic distortion <3%.
                    </p>
                </div>
            </div>
            </div>
        </div>

        <div class="page page-break">
            <div class="page-content">
            <!-- Continue Technical Solution -->
            <div class="section">
                <h3 class="section-title">3. Technical Solution (Cont.)</h3>

                <div class="chart-container">
                    <h4 class="chart-title">Liquid Cooling System Principle</h4>
                    <canvas id="coolingSystemChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>Full liquid-cooling heat dissipation technology:</strong> Adopts circulating coolant system, heat dissipation efficiency is 300% higher than traditional air cooling. System operating temperature range -40~65°C, coolant flow rate 20L/min, can dissipate 35kW of heat. Intelligent temperature control system monitors equipment temperature in real-time, automatically adjusts cooling power, ensuring charging modules operate within optimal temperature range, significantly extending equipment life.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Charging Station Layout</h4>
                    <canvas id="stationLayoutChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #555;">
                        <strong>Standardized station design:</strong> Single station occupies 1000m², layouts 12 units of 600kW ultra-fast charging piles, adopts 4×3 grid layout, ensuring convenient vehicle entry and exit. Stations equipped with restrooms, convenience stores and other supporting facilities to enhance user experience. Standardized design supports rapid replication construction, single station construction period only 45 days, significantly reducing construction costs.
                    </p>
                </div>

                <p>The system adopts modular design, supporting flexible expansion. Each charging station is configured with 12 units of 600kW liquid-cooled ultra-fast charging piles, with a total power of 7200kW. Through intelligent power distribution algorithms, it achieves precise matching of vehicle charging demands. The liquid-cooling heat dissipation system ensures 24/7 stable operation of equipment, with conversion efficiency exceeding 96%, providing reliable charging services for users. The entire system has fault self-healing capabilities, achieving 99.9% availability, supporting large-scale commercial operations.</p>
            </div>

            <!-- Investment Plan -->
            <div class="section">
                <h3 class="section-title">4. Investment Plan</h3>

                <h4 class="subsection-title">4.1 Investment Planning</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Phase</th>
                            <th>Time</th>
                            <th>Number of Stations</th>
                            <th>Investment (100M RMB)</th>
                            <th>Financing Ratio</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Phase 1</td>
                            <td>2024</td>
                            <td>100 stations</td>
                            <td>3.5</td>
                            <td>60%</td>
                        </tr>
                        <tr>
                            <td>Phase 2</td>
                            <td>2025</td>
                            <td>200 stations</td>
                            <td>6.8</td>
                            <td>65%</td>
                        </tr>
                        <tr>
                            <td>Phase 3</td>
                            <td>2026</td>
                            <td>300 stations</td>
                            <td>9.9</td>
                            <td>70%</td>
                        </tr>
                        <tr>
                            <td>Phase 4</td>
                            <td>2027</td>
                            <td>400 stations</td>
                            <td>12.8</td>
                            <td>75%</td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>Total</strong></td>
                            <td><strong>4 years</strong></td>
                            <td><strong>1000 stations</strong></td>
                            <td><strong>33.0</strong></td>
                            <td><strong>70%</strong></td>
                        </tr>
                    </tbody>
                </table>

                <h4 class="subsection-title">4.2 Financing Plan</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">2.31B</div>
                        <div class="data-label">Equity Financing (70%)</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">990M</div>
                        <div class="data-label">Debt Financing (30%)</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">300M</div>
                        <div class="data-label">Government Subsidies</div>
                    </div>
                </div>

                <h4 class="subsection-title">4.3 Exit Mechanisms</h4>
                <ol>
                    <li><strong>IPO Listing</strong>: Estimated valuation 500-800 billion RMB</li>
                    <li><strong>Strategic M&A</strong>: Expected return multiple 8-15x</li>
                    <li><strong>REITs Exit</strong>: Stable return 6-8%</li>
                </ol>
            </div>

            <!-- Financial Analysis -->
            <div class="section">
                <h3 class="section-title">5. Financial Analysis</h3>

                <h4 class="subsection-title">5.1 Investment Return Analysis</h4>
                <div class="highlight-box">
                    <h4 class="highlight-title">Key Financial Indicators</h4>
                    <div class="data-grid">
                        <div class="data-card">
                            <div class="data-value">2.8B</div>
                            <div class="data-label">Total Investment</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">42.8%</div>
                            <div class="data-label">Project IRR</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">1.24 Billion</div>
                            <div class="data-label">NPV@12%</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">4.5 Years</div>
                            <div class="data-label">Investment Payback Period</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">12.1 Billion</div>
                            <div class="data-label">10-Year Cumulative Net Profit</div>
                        </div>
                        <div class="data-card">
                            <div class="data-value">435%</div>
                            <div class="data-label">Return on Investment</div>
                        </div>
                    </div>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Cash Flow Forecast Analysis</h4>
                    <canvas id="investorCashFlowChart" width="500" height="280"></canvas>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Investment Return Rate Comparison</h4>
                    <canvas id="investorROIChart" width="500" height="280"></canvas>
                </div>
            </div>
            </div>
        </div>

        <!-- 第四页用于PDF导出 -->
        <div class="page page-break" id="pdf-third-page">
            <div class="page-content">
            <!-- 继续财务分析 -->
            <div class="section">
                <h3 class="section-title">5. Financial Analysis (Cont.)</h3>

                <h4 class="subsection-title">5.2 Sensitivity Analysis</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Scenario</th>
                            <th>IRR</th>
                            <th>Investment Payback Period</th>
                            <th>NPV@12%</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Pessimistic (-20%)</td>
                            <td>22.5%</td>
                            <td>6.8 years</td>
                            <td>420 million RMB</td>
                        </tr>
                        <tr class="highlight-row">
                            <td>Baseline</td>
                            <td>42.8%</td>
                            <td>4.5 years</td>
                            <td>1.24 billion RMB</td>
                        </tr>
                        <tr>
                            <td>Optimistic (+20%)</td>
                            <td>58.3%</td>
                            <td>3.2 years</td>
                            <td>2.18 billion RMB</td>
                        </tr>
                    </tbody>
                </table>

                <h4 class="subsection-title">5.3 REITs Securitization</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">20 Stations</div>
                        <div class="data-label">Initial REITs Station Count</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">210M</div>
                        <div class="data-label">Asset Valuation</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">6.0%</div>
                        <div class="data-label">Distributable Yield</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">170M</div>
                        <div class="data-label">Cash Return</div>
                    </div>
                </div>
            </div>

            <!-- 结论与建议 -->
            <div class="conclusion">
                <h3 class="conclusion-title">Investment Value Summary and Recommendations</h3>

                <h4 class="subsection-title">Core Investment Highlights</h4>
                <ol>
                    <li><strong>Technical Leadership Advantage</strong>: Huawei's liquid-cooled ultra-fast charging technology holds industry-leading position</li>
                    <li><strong>Superior Market Timing</strong>: Explosive growth in new energy vehicle market</li>
                    <li><strong>Generous Financial Returns</strong>: 42.8% IRR, 4.5-year investment payback period</li>
                    <li><strong>Comprehensive Risk Control</strong>: Multiple exit mechanisms, controllable risk</li>
                    <li><strong>Significant Social Benefits</strong>: Supporting national carbon neutrality strategy</li>
                </ol>

                <h4 class="subsection-title">Investment Recommendations</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">Strong Buy</div>
                        <div class="data-label">Investment Rating</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">2.31B</div>
                        <div class="data-label">Recommended Investment</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">5-7 Years</div>
                        <div class="data-label">Investment Period</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">15-25x</div>
                        <div class="data-label">Expected Returns</div>
                    </div>
                </div>

                <h4 class="subsection-title">Immediate Action Items</h4>
                <ol>
                    <li><strong>Funding in Place</strong>: Complete SPA and funding arrival within 90 days</li>
                    <li><strong>Team Building</strong>: Recruit core technical and operational teams</li>
                    <li><strong>Site Signing</strong>: Launch signing for first 100 sites</li>
                    <li><strong>Equipment Procurement</strong>: Sign equipment procurement agreement with Huawei</li>
                </ol>
            </div>

            <!-- 最后说明 -->
            <div class="contact">
                <p><em>This business plan contains forward-looking statements, actual investment returns may be adjusted due to market changes.</em></p>
            </div>
        </div>
    </div>

    <!-- PDF导出区域 -->
    <div id="pdf-export-area" style="display: none;">
        <!-- 隐藏的PDF导出区域 -->
    </div>

    <!-- 导出PDF按钮 -->
    <div class="pdf-export-section">
        <button class="pdf-export-btn" onclick="exportToPDF()">
            <span>📄</span>
            <span>Export to PDF</span>
        </button>
    </div>

    <script>
        // Chart rendering functions
        function renderInvestorMarketGrowthChart() {
            const canvas = document.getElementById('investorMarketGrowthChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Data
            const years = ['2020', '2021', '2022', '2023', '2024', '2025', '2026', '2027', '2028'];
            const salesData = [137, 352, 689, 950, 1200, 1500, 1850, 2250, 2700];
            const penetrationData = [5.4, 13.4, 25.6, 35.2, 42.0, 48.5, 54.2, 59.8, 64.5];

            // Set styles - 适配库里蓝暗夜主题
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                accent: '#FFC72C',
                text: '#FFFFFF',
                bg: '#B8C5E0'
            };

            // Draw coordinate axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 60);
            ctx.lineTo(width - 30, height - 60);
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 60);
            ctx.stroke();

            // 绘制销量曲线（左轴）
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 3;
            ctx.beginPath();

            const maxSales = Math.max(...salesData);
            const salesScale = (height - 100) / maxSales;

            salesData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 60 - value * salesScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // 绘制数据点
                ctx.fillStyle = colors.primary;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // 绘制渗透率曲线（右轴）
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.beginPath();

            const maxPenetration = Math.max(...penetrationData);
            const penetrationScale = (height - 100) / maxPenetration;

            penetrationData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 60 - value * penetrationScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // 绘制数据点
                ctx.fillStyle = colors.success;
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // Draw labels
            ctx.fillStyle = colors.text;
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';

            // X-axis labels
            years.forEach((year, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                ctx.fillText(year, x, height - 45);
            });

            // Legend
            ctx.fillStyle = colors.primary;
            ctx.fillRect(width - 150, 10, 15, 3);
            ctx.fillStyle = colors.primary;
            ctx.font = '11px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('Sales (10K units)', width - 130, 14);

            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 150, 25, 15, 3);
            ctx.fillText('Penetration Rate (%)', width - 130, 29);
        }

        function renderInvestorMarketSizeChart() {
            const canvas = document.getElementById('investorMarketSizeChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Data
            const segments = ['Liquid-Cooled Ultra-Fast Charging', 'Standard Fast Charging', 'Slow Charging', 'Others'];
            const marketData = [800, 1200, 600, 400];
            const colors = ['#1D428A', '#0077C0', '#10B981', '#FFC72C'];

            // 绘制饼图
            const centerX = width / 2;
            const centerY = height / 2 - 10;
            const radius = Math.min(width, height) / 3;

            const total = marketData.reduce((sum, value) => sum + value, 0);
            let currentAngle = -Math.PI / 2;

            marketData.forEach((value, index) => {
                const sliceAngle = (value / total) * 2 * Math.PI;

                // 绘制扇形
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.lineTo(centerX, centerY);
                ctx.fillStyle = colors[index];
                ctx.fill();

                // 绘制边框
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 2;
                ctx.stroke();

                // 绘制百分比标签
                const percentage = ((value / total) * 100).toFixed(1);
                const labelAngle = currentAngle + sliceAngle / 2;
                const labelX = centerX + Math.cos(labelAngle) * (radius * 0.7);
                const labelY = centerY + Math.sin(labelAngle) * (radius * 0.7);

                ctx.fillStyle = '#ffffff';
                ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(percentage + '%', labelX, labelY);

                currentAngle += sliceAngle;
            });

            // 添加图例
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';

            segments.forEach((segment, index) => {
                const legendY = 20 + index * 20;
                ctx.fillStyle = colors[index];
                ctx.fillRect(10, legendY - 8, 12, 12);

                ctx.fillStyle = '#374151';
                ctx.fillText(`${segment}: ${marketData[index]} hundred million RMB`, 28, legendY);
            });

            // 添加标题
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('2028 Charging Pile Market Size Forecast (100M RMB)', width / 2, height - 10);
        }

        function renderInvestorCashFlowChart() {
            const canvas = document.getElementById('investorCashFlowChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Data
            const years = ['Year 1', 'Year 2', 'Year 3', 'Year 4', 'Year 5', 'Year 6', 'Year 7', 'Year 8', 'Year 9', 'Year 10'];
            const cashFlowData = [-28.0, 13.5, 14.8, 17.9, 21.3, 26.5, 28.9, 31.2, 33.8, 36.5];
            const cumulativeData = [-28.0, -14.5, 0.3, 18.2, 39.5, 66.0, 94.9, 126.1, 159.9, 196.4];

            // Set styles
            const colors = {
                primary: '#1D428A',
                success: '#10B981',
                danger: '#EF4444'
            };

            // Draw coordinate axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 40);
            ctx.stroke();

            // 绘制现金流柱状图
            const barWidth = (width - 100) / years.length * 0.6;
            const scale = (height - 80) / 50;

            cashFlowData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length - barWidth) / 2;
                const barHeight = Math.abs(value) * scale;
                const y = value >= 0 ? height - 40 - barHeight : height - 40;

                ctx.fillStyle = value >= 0 ? colors.success : colors.danger;
                ctx.fillRect(x, y, barWidth, barHeight);

                // 绘制数值标签
                ctx.fillStyle = '#374151';
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value.toFixed(1), x + barWidth / 2, y - 5);
            });

            // 绘制累计现金流曲线
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 2;
            ctx.beginPath();

            cumulativeData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / (years.length - 1));
                const y = height - 40 - (value + 30) * scale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            ctx.stroke();

            // 绘制X轴标签
            ctx.fillStyle = '#6b7280';
            ctx.font = '10px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            years.forEach((year, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length) / 2;
                ctx.fillText(year, x, height - 25);
            });

            // 添加图例
            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 150, 10, 15, 10);
            ctx.fillStyle = '#374151';
            ctx.font = '11px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('Annual Cash Flow', width - 130, 19);

            ctx.fillStyle = colors.primary;
            ctx.fillRect(width - 150, 25, 15, 2);
            ctx.fillText('Cumulative Cash Flow', width - 130, 29);
        }

        function renderInvestorROIChart() {
            const canvas = document.getElementById('investorROIChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // 限制最大宽度
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Data
            const scenarios = ['Conservative', 'Base', 'Optimistic'];
            const irrData = [35.6, 42.8, 50.2];
            const multipleData = [12.5, 18.3, 25.8];

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C'
            };

            // Draw coordinate axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(60, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(60, 20);
            ctx.lineTo(60, height - 40);
            ctx.stroke();

            // 绘制IRR柱状图
            const barWidth = 80;
            const spacing = (width - 120) / scenarios.length;
            const irrScale = (height - 80) / 60;

            irrData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - barWidth / 2;
                const barHeight = value * irrScale;
                const y = height - 40 - barHeight;

                // 渐变填充
                const gradient = ctx.createLinearGradient(0, y, 0, height - 40);
                gradient.addColorStop(0, colors.primary);
                gradient.addColorStop(1, colors.secondary);
                ctx.fillStyle = gradient;
                ctx.fillRect(x, y, barWidth, barHeight);

                // 绘制数值标签
                ctx.fillStyle = '#374151';
                ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value + '%', x + barWidth / 2, y - 5);

                // 绘制场景标签
                ctx.fillStyle = '#6b7280';
                ctx.font = '12px "Microsoft YaHei", sans-serif';
                ctx.fillText(scenarios[index], x + barWidth / 2, height - 25);
            });

            // 添加标题
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 14px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Internal Rate of Return (IRR) Comparative Analysis', width / 2, 15);

            // 绘制收益倍数指示器
            const multipleY = height - 70;
            ctx.font = '12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';
            multipleData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - 30;
                ctx.fillStyle = colors.accent;
                ctx.fillText(`${value}倍`, x, multipleY);
            });
        }

        // 系统架构图渲染函数
        function renderSystemArchitectureChart() {
            const canvas = document.getElementById('systemArchitectureChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40; // 减去padding
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // Background
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制三层架构
            const layers = [
                {
                    name: 'Cloud Management Platform',
                    y: 40,
                    color: colors.primary,
                    components: ['Operations Management', 'Data Analytics', 'Customer Service', 'Monitoring']
                },
                {
                    name: 'Station Management System',
                    y: 120,
                    color: colors.secondary,
                    components: ['Power Distribution', 'Environmental Monitoring', 'Security Protection', 'Billing System']
                },
                {
                    name: 'Charging Device Layer',
                    y: 200,
                    color: colors.accent,
                    components: ['Charging Piles', 'Energy Storage', 'Photovoltaic', 'SmartPowerDistribution']
                }
            ];

            const componentWidth = Math.min(160, (width - 120) / 4);

            layers.forEach((layer, index) => {
                // 绘制层级标题背景
                ctx.fillStyle = layer.color;
                ctx.fillRect(30, layer.y - 15, width - 60, 35);

                // 绘制层级标题
                ctx.fillStyle = colors.text;
                ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(layer.name, width / 2, layer.y + 8);

                // Draw components
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                layer.components.forEach((component, compIndex) => {
                    const compX = 50 + compIndex * (componentWidth + 20);
                    const compY = layer.y + 30;

                    // 组件背景
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.fillRect(compX, compY, componentWidth, 25);

                    // 组件边框
                    ctx.strokeStyle = layer.color;
                    ctx.lineWidth = 1;
                    ctx.strokeRect(compX, compY, componentWidth, 25);

                    // 组件文字 - 处理文字重叠
                    ctx.fillStyle = '#333';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    // 如果文字太长，自动缩小字体
                    let fontSize = 12;
                    ctx.font = `${fontSize}px "Microsoft YaHei", sans-serif`;
                    const textWidth = ctx.measureText(component).width;

                    if (textWidth > componentWidth - 10) {
                        fontSize = Math.max(9, fontSize - 2);
                        ctx.font = `${fontSize}px "Microsoft YaHei", sans-serif`;
                    }

                    ctx.fillText(component, compX + componentWidth / 2, compY + 12.5);
                });

                // 绘制连接线和箭头
                if (index < layers.length - 1) {
                    ctx.strokeStyle = colors.grid;
                    ctx.lineWidth = 2;

                    // 多条连接线
                    for (let i = 0; i < 4; i++) {
                        const startX = 50 + i * (componentWidth + 15) + componentWidth / 2;
                        const startY = layer.y + 55;
                        const endY = layers[index + 1].y - 15;

                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(startX, endY);
                        ctx.stroke();

                        // 箭头
                        ctx.beginPath();
                        ctx.moveTo(startX - 3, endY - 5);
                        ctx.lineTo(startX, endY);
                        ctx.lineTo(startX + 3, endY - 5);
                        ctx.stroke();
                    }
                }
            });

            // Add data flow indicator - Place on left side
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 3]);
            ctx.beginPath();
            ctx.moveTo(40, 40);
            ctx.lineTo(40, 240);
            ctx.stroke();
            ctx.setLineDash([]);

            // 绘制向下的箭头 - 放在虚线下方
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(40, 235);
            ctx.lineTo(35, 245);
            ctx.moveTo(40, 235);
            ctx.lineTo(45, 245);
            ctx.stroke();

            // Data流向文字 - 放在左侧
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.save();
            ctx.translate(40, 140);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Data Flow Direction', 0, 0);
            ctx.restore();
        }

        function renderPowerSystemChart() {
            const canvas = document.getElementById('powerSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40;
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // Background
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制电力系统流程
            const componentWidth = Math.min(110, (width - 140) / 5);
            const components = [
                {
                    name: '10kV/20kV Grid',
                    specs: '10kV/20kV',
                    x: 20,
                    y: 120,
                    color: colors.primary
                },
                {
                    name: 'Transformer',
                    specs: '2000-5000kVA',
                    x: 20 + (componentWidth + 25) * 1,
                    y: 120,
                    color: colors.secondary
                },
                {
                    name: 'Distribution',
                    specs: '400V系统',
                    x: 20 + (componentWidth + 25) * 2,
                    y: 120,
                    color: colors.accent
                },
                {
                    name: 'PowerDistribution',
                    specs: '7200kW',
                    x: 20 + (componentWidth + 25) * 3,
                    y: 120,
                    color: colors.success
                },
                {
                    name: 'Charging Piles',
                    specs: '12×600kW',
                    x: 20 + (componentWidth + 25) * 4,
                    y: 120,
                    color: colors.warning
                }
            ];

            components.forEach((comp, index) => {
                // Draw components
                ctx.fillStyle = comp.color;
                ctx.fillRect(comp.x, comp.y, componentWidth, 60);

                // Draw components文字 - 处理文字重叠
                ctx.fillStyle = colors.text;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                // 调整组件文字字体大小
                let nameFontSize = 10;
                ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                const nameWidth = ctx.measureText(comp.name).width;

                if (nameWidth > componentWidth - 10) {
                    nameFontSize = Math.max(9, nameFontSize - 2);
                    ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.name, comp.x + componentWidth / 2, comp.y + 20);

                // 绘制规格文字
                let specsFontSize = 10;
                ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                const specsWidth = ctx.measureText(comp.specs).width;

                if (specsWidth > componentWidth - 10) {
                    specsFontSize = Math.max(8, specsFontSize - 1);
                    ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.specs, comp.x + componentWidth / 2, comp.y + 40);
            });

            // 绘制连接箭头
            ctx.strokeStyle = colors.grid;
            ctx.lineWidth = 3;
            for (let i = 0; i < components.length - 1; i++) {
                const start = components[i];
                const end = components[i + 1];

                ctx.beginPath();
                ctx.moveTo(start.x + componentWidth, start.y + 30);
                ctx.lineTo(end.x, end.y + 30);
                ctx.stroke();

                // 箭头
                ctx.beginPath();
                ctx.moveTo(end.x - 8, end.y + 25);
                ctx.lineTo(end.x, end.y + 30);
                ctx.lineTo(end.x - 8, end.y + 35);
                ctx.stroke();
            }

            // 删除顶部绿色虚线 - 根据用户需求

            // Power flow direction - Place at bottom with right arrow
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.setLineDash([8, 4]);
            ctx.beginPath();
            ctx.moveTo(60, height - 40);
            ctx.lineTo(width - 60, height - 40);
            ctx.stroke();
            ctx.setLineDash([]);

            // 绘制向右的箭头 - 确保箭头指向正确方向
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(width - 65, height - 40);
            ctx.lineTo(width - 55, height - 45);
            ctx.moveTo(width - 65, height - 40);
            ctx.lineTo(width - 55, height - 35);
            ctx.stroke();

            // Power flow text
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Power Flow Direction', width / 2, height - 55);
        }

        function renderCoolingSystemChart() {
            const canvas = document.getElementById('coolingSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40;
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // Background
            ctx.fillStyle = colors.bg;
            ctx.fillRect(0, 0, width, height);

            // 绘制液冷循环系统
            const centerX = width / 2;
            const centerY = height / 2 + 10;
            const radius = Math.max(20, Math.min(100, width / 4)); // 确保半径至少为20px

            // 外圈循环管路
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 4;
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius, 0, 2 * Math.PI);
            ctx.stroke();

            // 内圈循环管路
            const innerRadius = Math.max(10, radius - 30); // 确保半径不为负数
            ctx.strokeStyle = colors.secondary;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, innerRadius, 0, 2 * Math.PI);
            ctx.stroke();

            // 组件位置和规格
            const components = [
                {
                    name: 'Charging Module',
                    specs: '600kW',
                    x: centerX - radius,
                    y: centerY,
                    color: colors.warning,
                    temp: '65°C'
                },
                {
                    name: 'Coolant',
                    specs: 'Ethylene Glycol',
                    x: centerX,
                    y: centerY - radius,
                    color: colors.accent,
                    temp: '25°C'
                },
                {
                    name: 'Radiator',
                    specs: 'LiquidCool Plate',
                    x: centerX + radius,
                    y: centerY,
                    color: colors.success,
                    temp: '35°C'
                },
                {
                    name: 'Water Pump',
                    specs: '200L/min',
                    x: centerX,
                    y: centerY + radius,
                    color: colors.primary,
                    temp: '28°C'
                }
            ];

            components.forEach((comp, index) => {
                // Draw components圆圈
                const componentRadius = Math.max(5, Math.min(35, radius / 3)); // 动态调整组件半径
                ctx.fillStyle = comp.color;
                ctx.beginPath();
                ctx.arc(comp.x, comp.y, componentRadius, 0, 2 * Math.PI);
                ctx.fill();

                // Draw components边框
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.8)';
                ctx.lineWidth = 2;
                ctx.stroke();

                // Draw components名称 - 处理文字重叠
                ctx.fillStyle = colors.text;
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';

                let nameFontSize = 10;
                ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                const nameWidth = ctx.measureText(comp.name).width;

                if (nameWidth > 60) {
                    nameFontSize = Math.max(9, nameFontSize - 2);
                    ctx.font = `bold ${nameFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.name, comp.x, comp.y - 10);

                // 绘制规格
                let specsFontSize = 10;
                ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                const specsWidth = ctx.measureText(comp.specs).width;

                if (specsWidth > 60) {
                    specsFontSize = Math.max(8, specsFontSize - 1);
                    ctx.font = `${specsFontSize}px "Microsoft YaHei", sans-serif`;
                }

                ctx.fillText(comp.specs, comp.x, comp.y + 2);

                // 绘制温度
                ctx.fillStyle = colors.accent;
                ctx.font = '9px "Microsoft YaHei", sans-serif';
                ctx.fillText(comp.temp, comp.x, comp.y + 14);
            });

            // Remove coolant flow arrows - According to user requirements

            // 添加效率指标
            const metrics = [
                { label: 'Cooling Efficiency', value: '300W/°C', improvement: '+300%' },
                { label: 'Noise Control', value: '<60dB', improvement: '-20%' },
                { label: '', value: '', improvement: '' },
                { label: 'Conversion Efficiency', value: '>96%', improvement: '+3%' }
            ];

            metrics.forEach((metric, index) => {
                const x = 20 + index * 120;
                const y = height - 35;

                ctx.fillStyle = colors.primary;
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.label, x, y);

                ctx.fillStyle = colors.primary; // 修改value颜色与label相同
                ctx.font = 'bold 11px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.value, x, y + 15);

                ctx.fillStyle = colors.success;
                ctx.font = '10px "Microsoft YaHei", sans-serif';
                ctx.fillText(metric.improvement, x, y + 30);
            });

            // 删除标题"液冷系统原理图" - 根据用户需求
        }

        function renderStationLayoutChart() {
            const canvas = document.getElementById('stationLayoutChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = container.offsetWidth - 40; // Full width
            const height = 320;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                light: '#B8C5E0',
                text: '#1D428A',
                white: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)'
            };

            // 绘制背景渐变
            const bgGradient = ctx.createLinearGradient(0, 0, width, height);
            bgGradient.addColorStop(0, 'rgba(255, 255, 255, 0.98)');
            bgGradient.addColorStop(1, 'rgba(184, 197, 224, 0.3)');
            ctx.fillStyle = bgGradient;
            ctx.fillRect(0, 0, width, height);

            // 绘制充电站布局区域
            const stationWidth = Math.min(width - 80, 600);
            const stationHeight = 180;
            const stationX = (width - stationWidth) / 2;
            const stationY = 60;

            // 站点区域背景
            ctx.fillStyle = 'rgba(29, 66, 138, 0.05)';
            ctx.fillRect(stationX - 10, stationY - 10, stationWidth + 20, stationHeight + 60);

            // 站点边框
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 3;
            ctx.setLineDash([]);
            ctx.strokeRect(stationX, stationY, stationWidth, stationHeight);

            // Draw charging pile layout (4x3 grid) - Optimize size to avoid overlap
            const chargerCols = 4;
            const chargerRows = 3;
            const chargerWidth = Math.min(stationWidth / (chargerCols + 1) - 5, 80);
            const chargerHeight = 28;
            const chargerSpacingX = stationWidth / (chargerCols + 1);
            const chargerSpacingY = 42;
            const startX = stationX + chargerSpacingX / 2;
            const startY = stationY + 25;

            for (let row = 0; row < chargerRows; row++) {
                for (let col = 0; col < chargerCols; col++) {
                    const x = startX + col * chargerSpacingX;
                    const y = startY + row * chargerSpacingY;

                    // Charging pile outer frame
                    ctx.fillStyle = colors.primary;
                    ctx.fillRect(x - chargerWidth/2, y - chargerHeight/2, chargerWidth, chargerHeight);

                    // Charging pile inner frame
                    ctx.fillStyle = colors.accent;
                    ctx.fillRect(x - chargerWidth/2 + 3, y - chargerHeight/2 + 3, chargerWidth - 6, chargerHeight - 6);

                    // Charging pile identifier
                    ctx.fillStyle = colors.text;
                    ctx.font = 'bold 10px "Microsoft YaHei", sans-serif';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';
                    ctx.fillText(`600kW`, x, y);
                }
            }

            // Draw entrance and exit
            // Entrance
            ctx.fillStyle = colors.secondary;
            ctx.fillRect(stationX - 25, stationY + stationHeight/2 - 20, 25, 40);
            ctx.fillStyle = colors.white;
            ctx.font = 'bold 12px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            ctx.fillText('IN', stationX - 12, stationY + stationHeight/2);

            // Exit
            ctx.fillStyle = colors.secondary;
            ctx.fillRect(stationX + stationWidth, stationY + stationHeight/2 - 20, 25, 40);
            ctx.fillStyle = colors.white;
            ctx.fillText('Exit', stationX + stationWidth + 12, stationY + stationHeight/2);

            // Draw road markings
            ctx.strokeStyle = colors.light;
            ctx.lineWidth = 2;
            ctx.setLineDash([10, 5]);

            // Entrance road
            ctx.beginPath();
            ctx.moveTo(stationX - 25, stationY + stationHeight/2);
            ctx.lineTo(0, stationY + stationHeight/2);
            ctx.stroke();

            // Exit road
            ctx.beginPath();
            ctx.moveTo(stationX + stationWidth + 25, stationY + stationHeight/2);
            ctx.lineTo(width, stationY + stationHeight/2);
            ctx.stroke();

            // 添加技术规格标注
            ctx.setLineDash([]);
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 16px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Ultra-Fast Charging Station Standard Layout Design', width / 2, 30);

            // 添加详细技术参数
            ctx.font = '10px "Microsoft YaHei", sans-serif';
            ctx.textAlign = 'left';

            // 左侧参数
            ctx.fillText(`• Number of Charging Piles: ${chargerCols * chargerRows} units`, 20, height - 55);
            ctx.fillText(`• Single Pile Power: 600kW`, 20, height - 40);
            ctx.fillText(`• Total Power: ${(chargerCols * chargerRows * 600).toLocaleString()}kW`, 20, height - 25);

            // 右侧参数
            ctx.textAlign = 'right';
            ctx.fillText('• Land Area: 1000m²', width - 20, height - 55);
            ctx.fillText('• Service Spaces: 12 units', width - 20, height - 40);
            ctx.fillText('• Max Current: 600A', width - 20, height - 25);

            // Add legend - Centered at bottom of chart
            const legendY = stationY + stationHeight + 45;
            const legendItems = [
                { color: colors.accent, label: 'Charging Piles  ' },
                { color: colors.light, label: ' Traffic Lane' }
            ];

            // Calculate total legend width and center
            const legendItemWidth = 100; // Width of each legend item
            const totalLegendWidth = legendItems.length * legendItemWidth;
            const legendStartX = stationX + (stationWidth - totalLegendWidth) / 2;

            legendItems.forEach((item, index) => {
                const legendX = legendStartX + index * legendItemWidth;

                // Legend色块
                ctx.fillStyle = item.color;
                ctx.fillRect(legendX, legendY, 15, 15);

                // Legend文字
                ctx.fillStyle = colors.text;
                ctx.font = '9px "Microsoft YaHei", sans-serif';
                ctx.textAlign = 'left';
                ctx.fillText(item.label, legendX + 20, legendY + 12);
            });
        }

        // 图片错误处理
        function handleImageError(img) {
            img.style.display = 'none';
            const wrapper = img.parentElement;
            const errorDiv = document.createElement('div');
            errorDiv.style.cssText = 'padding: 20px; background: #f8f9fa; border: 2px dashed #dee2e6; border-radius: 8px; text-align: center; color: #6c757d;';
            errorDiv.innerHTML = '图片加载失败<br><small>' + img.alt + '</small>';
            wrapper.appendChild(errorDiv);
        }

        // PDF export function
        function exportToPDF() {
            const exportBtn = document.querySelector('.pdf-export-btn');
            const originalText = exportBtn.innerHTML;

            // Show loading status
            exportBtn.innerHTML = '<span>⏳</span><span>Generating...</span>';
            exportBtn.disabled = true;

            // Create hidden iframe for printing
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.right = '0';
            iframe.style.bottom = '0';
            iframe.style.width = '0';
            iframe.style.height = '0';
            iframe.style.border = 'none';

            document.body.appendChild(iframe);

            // Re-render all Canvas charts to ensure complete content during PDF export
            setTimeout(() => {
                // Call all chart rendering functions
                renderInvestorMarketGrowthChart();
                renderInvestorMarketSizeChart();
                renderInvestorCashFlowChart();
                renderInvestorROIChart();
                renderSystemArchitectureChart();
                renderPowerSystemChart();
                renderCoolingSystemChart();
                renderStationLayoutChart();

                // Convert Canvas to images to ensure complete content during PDF export
                setTimeout(() => {
                    const canvases = document.querySelectorAll('canvas');
                    const canvasPromises = [];

                    canvases.forEach((canvas, index) => {
                        const promise = new Promise((resolve) => {
                            try {
                                // 将canvas转换为base64图片
                                const dataURL = canvas.toDataURL('image/png', 1.0);
                                const img = document.createElement('img');

                                // 确保图片加载完成
                                img.onload = () => {
                                    // Set styles，避免overflow: visible警告
                                    img.style.cssText = canvas.style.cssText + '; max-width: 100%; height: auto; display: block; overflow: hidden;';
                                    img.className = canvas.className + ' canvas-replacement';
                                    img.id = canvas.id + '-img';

                                    // 替换原始canvas
                                    canvas.parentNode.replaceChild(img, canvas);
                                    resolve();
                                };

                                img.onerror = () => {
                                    console.warn('Canvas图片加载失败:', canvas.id);
                                    resolve();
                                };

                                img.src = dataURL;
                            } catch (error) {
                                console.warn('Canvas转换失败:', canvas.id, error);
                                resolve();
                            }
                        });
                        canvasPromises.push(promise);
                    });

                    // 等待所有图片都加载完成
                    Promise.all(canvasPromises).then(() => {
                        console.log('所有Canvas图表已转换为图片');
                    });
                }, 200);
            }, 300);

            // 获取页面内容 - 等待图片完全加载
            setTimeout(() => {
                const pageContent = document.querySelector('.page-container').innerHTML;

                // 创建新窗口的内容 - 优化WYSIWYG效果
            const printContent = `
                <!DOCTYPE html>
                <html lang="zh-CN">
                <head>
                    <meta charset="UTF-8">
                    <title>Thousand-Station Liquid-Cooled Ultra-Fast Charging Project Business Plan</title>
                    <style>
                        @page {
                            size: A4;
                            margin: 15mm;
                        }

                        * {
                            box-sizing: border-box;
                        }

                        body {
                            font-family: 'Microsoft YaHei', 'SimHei', 'PingFang SC', -apple-system, BlinkMacSystemFont, Arial, sans-serif;
                            margin: 0;
                            padding: 0;
                            background: #ffffff;
                            color: #1a2332;
                            line-height: 1.6;
                            font-size: 14px;
                        }

                        .page-container {
                            display: block;
                            width: 100%;
                        }

                        .page {
                            width: 100%;
                            min-height: 277mm; /* A4 height minus margins */
                            margin: 0;
                            padding: 20mm;
                            background: #ffffff;
                            position: relative;
                            page-break-after: always;
                            overflow: hidden;
                            break-inside: avoid;
                        }

                        /* 图表容器避免分页 */
                        .chart-container, .canvas-container {
                            break-inside: avoid;
                            page-break-inside: avoid;
                            max-height: 200mm;
                            overflow: hidden;
                        }

                        canvas, .canvas-replacement {
                            break-inside: avoid;
                            page-break-inside: avoid;
                            max-height: 200mm;
                            max-width: 100% !important;
                            height: auto !important;
                            overflow: hidden;
                            display: block;
                        }

                        .page:last-child {
                            page-break-after: auto;
                        }

                        .page-content {
                            width: 100%;
                            height: 100%;
                        }

                        .page-number {
                            position: absolute;
                            bottom: 10mm;
                            right: 20mm;
                            font-size: 11px;
                            color: #666666;
                            font-family: Arial, sans-serif;
                        }

                        .header {
                            text-align: center;
                            margin-bottom: 30px;
                            border-bottom: 3px solid #FFC72C;
                            padding-bottom: 20px;
                        }

                        .title {
                            font-size: 32px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 10px;
                            text-shadow: none;
                        }

                        .subtitle {
                            font-size: 18px;
                            color: #0077C0;
                            margin-bottom: 5px;
                            font-weight: 500;
                        }

                        .meta {
                            font-size: 14px;
                            color: #666666;
                            margin: 5px 0;
                        }

                        .section {
                            margin-bottom: 25px;
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }

                        /* 防止图表跨页 */
                        .chart-container {
                            page-break-inside: avoid;
                            break-inside: avoid;
                            margin: 20px 0;
                        }

                        /* Canvas图表和替换图片样式 */
                        canvas, .canvas-replacement {
                            max-width: 100% !important;
                            height: auto !important;
                            page-break-inside: avoid;
                            break-inside: avoid;
                            margin: 10px 0;
                            overflow: hidden;
                            display: block;
                        }

                        /* 图表描述文本 */
                        .chart-description {
                            margin: 15px 0;
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }

                        .section-title {
                            font-size: 24px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            border-left: 5px solid #FFC72C;
                            padding-left: 15px;
                        }

                        .subsection-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #0077C0;
                            margin: 15px 0 10px 0;
                        }

                        .highlight-box {
                            background: rgba(255, 199, 44, 0.08);
                            border: 2px solid #FFC72C;
                            border-radius: 10px;
                            padding: 20px;
                            margin: 20px 0;
                        }

                        .highlight-title {
                            font-size: 20px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 10px;
                            text-align: center;
                        }

                        .data-grid {
                            display: grid;
                            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                            gap: 15px;
                            margin: 20px 0;
                        }

                        .data-card {
                            background: #f8f9fa;
                            border: 1px solid #e5e7eb;
                            border-radius: 8px;
                            padding: 15px;
                            text-align: center;
                            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
                        }

                        .data-value {
                            font-size: 22px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 5px;
                        }

                        .data-label {
                            font-size: 12px;
                            color: #666666;
                        }

                        table {
                            width: 100%;
                            border-collapse: collapse;
                            margin: 15px 0;
                            font-size: 12px;
                        }

                        th, td {
                            border: 1px solid #d1d5db;
                            padding: 10px 8px;
                            text-align: left;
                            vertical-align: top;
                        }

                        th {
                            background: #f1f3f4;
                            font-weight: bold;
                            color: #1D428A;
                            font-size: 12px;
                        }

                        .highlight-row {
                            background: #fff3cd;
                            font-weight: bold;
                        }

                        .chart-container {
                            margin: 25px 0;
                            padding: 20px;
                            background: #ffffff;
                            border: 1px solid #e5e7eb;
                            border-radius: 10px;
                            page-break-inside: avoid;
                        }

                        .chart-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            text-align: center;
                        }

                        canvas {
                            max-width: 100%;
                            height: auto !important;
                            background: #ffffff;
                            border-radius: 6px;
                        }

                        .tech-images-grid {
                            display: grid;
                            grid-template-columns: repeat(2, 1fr);
                            gap: 20px;
                            margin: 20px 0;
                        }

                        .conclusion {
                            background: rgba(255, 199, 44, 0.08);
                            border: 2px solid #FFC72C;
                            border-radius: 10px;
                            padding: 20px;
                            margin-top: 30px;
                        }

                        .conclusion-title {
                            font-size: 18px;
                            font-weight: bold;
                            color: #1D428A;
                            margin-bottom: 15px;
                            text-align: center;
                        }

                        .contact {
                            text-align: center;
                            margin-top: 30px;
                            padding-top: 20px;
                            border-top: 1px solid #d1d5db;
                            font-size: 12px;
                            color: #666666;
                        }

                        ul, ol {
                            margin: 10px 0;
                            padding-left: 25px;
                        }

                        li {
                            margin-bottom: 6px;
                            font-size: 14px;
                            line-height: 1.5;
                        }

                        p {
                            font-size: 14px;
                            line-height: 1.6;
                            margin-bottom: 12px;
                            text-align: justify;
                            color: #1a2332;
                        }

                        strong, b {
                            color: #1D428A;
                            font-weight: 600;
                        }

                        em, i {
                            color: #666666;
                            font-style: italic;
                        }

                        /* 打印优化 */
                        @media print {
                            @page {
                                size: A4;
                                margin: 15mm;
                            }

                            body {
                                margin: 0;
                                -webkit-print-color-adjust: exact;
                                color-adjust: exact;
                            }

                            .page {
                                margin: 0;
                                box-shadow: none;
                                border: none;
                            }

                            .chart-container {
                                page-break-inside: avoid;
                            }

                            .section {
                                page-break-inside: avoid;
                            }
                        }
                    </style>
                </head>
                <body>
                    ${pageContent
                        .replace('page page-break', 'page')
                        .replace('<div class="page page-break" id="pdf-third-page">', '<div class="page">')
                        .replace(/page-content/g, 'page-content')
                        .replace(/<style>.*?<\/style>/gis, '') // 移除原有样式
                    }
                </body>
                </html>
            `;

            // 将内容写入iframe
            iframe.contentDocument.open();
            iframe.contentDocument.write(printContent);
            iframe.contentDocument.close();

            // 等待内容加载完成
            setTimeout(() => {
                try {
                    // 触发打印对话框
                    iframe.contentWindow.print();

                    // 恢复按钮状态
                    setTimeout(() => {
                        exportBtn.innerHTML = originalText;
                        exportBtn.disabled = false;

                        // 移除iframe
                        document.body.removeChild(iframe);
                    }, 1000);
                } catch (error) {
                    console.error('PDF export failed:', error);

                    // 显示错误信息
                    exportBtn.innerHTML = '<span>❌</span><span>Export Failed</span>';
                    setTimeout(() => {
                        exportBtn.innerHTML = originalText;
                        exportBtn.disabled = false;
                    }, 2000);

                    // 移除iframe
                    document.body.removeChild(iframe);
                }
            }, 1500); // 增加等待时间确保内容完全加载
            });
        }

        // Initialize all charts after page load completes
        document.addEventListener('DOMContentLoaded', function() {
            // Delay rendering to ensure DOM elements are created
            setTimeout(() => {
                renderInvestorMarketGrowthChart();
                renderInvestorMarketSizeChart();
                renderInvestorCashFlowChart();
                renderInvestorROIChart();

                // 渲染系统架构图
                renderSystemArchitectureChart();
                renderPowerSystemChart();
                renderCoolingSystemChart();
                renderStationLayoutChart();

                // Set image error handling
                document.querySelectorAll('.content-image').forEach(img => {
                    img.onerror = function() {
                        handleImageError(this);
                    };
                });
            }, 100);
        });
    </script>
</body>
</html>
