<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="库里蓝暗夜主题.css">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thousand-Station Liquid-Cooled Ultra-Fast Charging Project Business Plan</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            color: #FFFFFF !important;
            background: #0A0E27;
            padding: 20px;
        }

        /* Normal page layout - cancel A4 page split */
        .page-container {
            display: block;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .page {
            width: 100%;
            background: rgba(26, 35, 71, 0.95);
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 40px;
            margin: 0 0 30px 0;
            position: relative;
        }

        .page:last-child {
            margin-bottom: 0;
            page-break-after: auto;
        }

        /* A4 page content container */
        .page-content {
            height: 100%;
            overflow: hidden; /* Single page mode no scrolling */
            position: relative;
        }

        /* A4 page size indicator */
        .page::before {
            content: '';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 40px;
            height: 56px;
            border: 1px dashed rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            z-index: 1;
        }

        /* Page number display */
        .page-number {
            position: absolute;
            bottom: 15px;
            right: 20px;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            font-weight: normal;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #FFC72C;
            padding-bottom: 20px;
        }

        .title {
            font-size: 32px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 18px;
            color: #B8C5E0 !important;
            margin-bottom: 5px;
        }

        .meta {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        .section {
            margin-bottom: 25px;
            page-break-inside: avoid;
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            border-left: 5px solid #FFC72C;
            padding-left: 15px;
        }

        .subsection-title {
            font-size: 18px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin: 15px 0 10px 0;
        }

        .highlight-box {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }

        .highlight-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 10px;
            text-align: center;
        }

        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .data-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .data-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.3);
            border-color: #FFC72C;
            background: rgba(255, 255, 255, 0.12);
        }

        .data-value {
            font-size: 24px;
            font-weight: bold;
            color: #FFC72C !important;
            margin-bottom: 5px;
        }

        .data-label {
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            border: 1px solid rgba(255, 255, 255, 0.1);
            padding: 12px;
            text-align: left;
        }

        th {
            background: rgba(255, 199, 44, 0.2);
            font-weight: bold;
            color: #FFFFFF !important;
        }

        td {
            color: #B8C5E0 !important;
        }

        .highlight-row {
            background: rgba(255, 199, 44, 0.15);
            font-weight: bold;
        }

        .highlight-row td {
            color: #FFFFFF !important;
        }

        p {
            margin-bottom: 15px;
            color: #B8C5E0 !important;
            line-height: 1.6;
            text-align: left;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 10px;
        }

        li {
            margin-bottom: 5px;
            color: #B8C5E0 !important;
        }

        strong {
            color: #FFFFFF;
        }

        /* Chart container styles */
        .chart-container {
            margin: 20px 0;
            padding: 18px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            page-break-inside: avoid;
            max-width: 100%;
            overflow: hidden;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-wrapper {
            text-align: center;
            background: #FFFFFF;
            border-radius: 8px;
            padding: 20px;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .conclusion {
            background: rgba(255, 199, 44, 0.1);
            border: 2px solid #FFC72C;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
        }

        .conclusion-title {
            font-size: 20px;
            font-weight: bold;
            color: #FFFFFF !important;
            margin-bottom: 15px;
            text-align: center;
        }

        .contact {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 14px;
            color: #B8C5E0 !important;
        }

        /* Key metrics styles */
        .key-metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .metric-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #FFC72C;
            margin-bottom: 5px;
        }

        .metric-label {
            font-size: 14px;
            color: #FFFFFF;
        }

        /* Action buttons */
        .action-buttons {
            text-align: center;
            margin: 40px 0;
        }

        .btn {
            display: inline-block;
            padding: 12px 30px;
            margin: 0 10px;
            background: linear-gradient(45deg, #1D428A, #0077C0);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(29, 66, 138, 0.3);
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .page-container {
                padding: 15px;
            }

            .page {
                padding: 30px 20px;
                margin: 0 auto 20px;
            }

            .title {
                font-size: 28px;
            }

            .section-title {
                font-size: 20px;
            }

            .data-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 15px;
            }

            .chart-wrapper {
                padding: 15px;
                min-height: 150px;
            }
        }

        @media (max-width: 480px) {
            .page-container {
                padding: 5px;
            }

            .page {
                padding: 20px 15px;
                margin: 0 auto 15px;
            }

            .title {
                font-size: 24px;
            }

            .section-title {
                font-size: 18px;
            }

            .data-grid {
                grid-template-columns: 1fr;
            }

            .data-value {
                font-size: 20px;
            }
        }

        /* Print style optimization */
        @media print {
            body {
                background: white;
                padding: 0;
            }

            .page-container {
                display: block !important;
                max-width: none;
                padding: 0;
            }

            .page {
                width: 210mm;
                min-height: 297mm;
                max-width: none;
                margin: 0;
                padding: 15mm;
                background: white;
                box-shadow: none;
                border: none;
                border-radius: 0;
                page-break-after: always;
                overflow: hidden;
            }

            .page:last-child {
                page-break-after: auto;
            }

            .page-content {
                overflow: hidden;
            }

            .page-number {
                color: #666 !important;
            }

            .chart-container {
                background: white;
                border: 1px solid #ddd;
                page-break-inside: avoid;
            }

            .data-card {
                background: #f8f9fa;
                border: 1px solid #e9ecef;
                color: #333;
            }

            .data-value {
                color: #1D428A !important;
            }

            .data-label {
                color: #666 !important;
            }

            /* Section title styling for print */
            .section-title {
                color: #1D428A !important;
                font-size: 24px !important;
                font-weight: bold !important;
                border-left: 5px solid #FFC72C !important;
                padding-left: 15px !important;
                margin-bottom: 15px !important;
            }

            .subsection-title {
                color: #0077C0 !important;
                font-size: 18px !important;
                font-weight: bold !important;
                margin: 15px 0 10px 0 !important;
            }

            /* Chart styling for print */
            .chart-container {
                background: white !important;
                border: 1px solid #ddd !important;
                border-radius: 8px !important;
                padding: 15px !important;
                margin: 20px 0 !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .chart-title {
                color: #1D428A !important;
                font-size: 18px !important;
                font-weight: bold !important;
                margin-bottom: 15px !important;
                text-align: center !important;
            }

            /* Table styling for print */
            table {
                width: 100% !important;
                border-collapse: collapse !important;
                margin: 15px 0 !important;
                font-size: 12px !important;
                background: white !important;
            }

            th, td {
                border: 1px solid #d1d5db !important;
                padding: 8px !important;
                text-align: left !important;
                vertical-align: top !important;
            }

            th {
                background: #f1f3f4 !important;
                font-weight: bold !important;
                color: #1D428A !important;
                font-size: 12px !important;
            }

            /* Highlight boxes for print */
            .highlight-box {
                background: rgba(255, 199, 44, 0.08) !important;
                border: 2px solid #FFC72C !important;
                border-radius: 10px !important;
                padding: 20px !important;
                margin: 20px 0 !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .highlight-title {
                color: #1D428A !important;
                font-size: 20px !important;
                font-weight: bold !important;
                margin-bottom: 10px !important;
                text-align: center !important;
            }

            /* Text styling for print */
            p {
                color: #1a2332 !important;
                font-size: 14px !important;
                line-height: 1.6 !important;
                margin-bottom: 12px !important;
                text-align: justify !important;
            }

            strong, b {
                color: #1D428A !important;
                font-weight: 600 !important;
            }

            /* Conclusion section for print */
            .conclusion {
                background: rgba(255, 199, 44, 0.08) !important;
                border: 2px solid #FFC72C !important;
                border-radius: 10px !important;
                padding: 20px !important;
                margin-top: 30px !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .conclusion-title {
                color: #1D428A !important;
                font-size: 18px !important;
                font-weight: bold !important;
                margin-bottom: 15px !important;
                text-align: center !important;
            }

            /* Contact section for print */
            .contact {
                text-align: center !important;
                margin-top: 30px !important;
                padding-top: 20px !important;
                border-top: 1px solid #d1d5db !important;
                font-size: 12px !important;
                color: #666 !important;
            }

            /* Risk metrics cards for print */
            .key-metrics {
                display: grid !important;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
                gap: 15px !important;
                margin: 20px 0 !important;
            }

            .metric-card {
                background: #f8f9fa !important;
                border: 1px solid #e9ecef !important;
                border-radius: 8px !important;
                padding: 15px !important;
                text-align: center !important;
                page-break-inside: avoid !important;
                break-inside: avoid !important;
            }

            .metric-value {
                font-size: 20px !important;
                font-weight: bold !important;
                color: #1D428A !important;
                margin-bottom: 5px !important;
            }

            .metric-label {
                font-size: 12px !important;
                color: #666 !important;
            }

            /* Financial tables with special styling */
            .data-table {
                background: white !important;
                border: 1px solid #ddd !important;
                border-radius: 8px !important;
                overflow: hidden !important;
                margin: 15px 0 !important;
            }

            .data-table table {
                margin: 0 !important;
                border: none !important;
            }

            .data-table th {
                background: rgba(29, 66, 138, 0.8) !important;
                color: white !important;
                border: 1px solid rgba(255, 255, 255, 0.1) !important;
                padding: 12px 8px !important;
                font-size: 13px !important;
                text-align: center !important;
            }

            .data-table td {
                padding: 10px 8px !important;
                font-size: 12px !important;
                border: 1px solid rgba(255, 255, 255, 0.1) !important;
            }

            .highlight-row {
                background: #fff3cd !important;
                font-weight: bold !important;
            }

            /* Title styling for print */
            .title {
                font-size: 28px !important;
                font-weight: bold !important;
                color: #1D428A !important;
                margin: 0 0 15px 0 !important;
                line-height: 1.3 !important;
                text-shadow: none !important;
                text-align: center !important;
            }

            /* Header styling for print */
            .header {
                text-align: center !important;
                margin-bottom: 15px !important;
                padding: 20px 0 15px 0 !important;
                border-bottom: 2px solid #0077C0 !important;
                page-break-inside: avoid !important;
                page-break-after: avoid !important;
            }

            /* Subtitle and meta styling */
            .subtitle {
                color: #0077C0 !important;
                font-size: 18px !important;
                margin-bottom: 5px !important;
                font-weight: 500 !important;
            }

            .meta {
                color: #666666 !important;
                font-size: 14px !important;
                margin: 5px 0 !important;
            }

            /* 优化首页整体布局 */
            .page:first-child .page-content {
                padding-top: 20px !important;
                page-break-before: avoid !important;
                page-break-inside: avoid !important;
            }

            /* 打印时显示所有页面 */
            .page {
                display: block !important;
            }

            /* PDF导出按钮在打印时隐藏 */
            .pdf-export-section {
                display: none !important;
            }
        }

        /* 图表容器避免分页 */
        .chart-container, .canvas-container {
            break-inside: avoid;
            page-break-inside: avoid;
            max-height: 200mm;
            overflow: hidden;
        }

  
        /* 首页标题页在打印时独占一页 */
        .page:first-child .page-content {
            padding-top: 20px !important;
            page-break-before: avoid !important;
            page-break-inside: avoid !important;
        }

        /* 标题在导出时正常布局 - 不独占一页 */
        .page:first-child .header {
            text-align: center !important;
            margin-bottom: 30px !important;
            padding: 30px 20px !important;
            border-bottom: 3px solid #FFC72C !important;
            margin-top: 0 !important;
        }

        /* 调整首页内容在打印时的布局 */
        .page:first-child .section:first-child {
            margin-top: 0 !important;
        }

        /* 隐藏页面尺寸标识 */
        .page::before {
            display: none !important;
        }

        /* 隐藏页码 */
        .page-number {
            display: none !important;
        }


        /* PDF export button */
        .pdf-export-section {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
        }

        .pdf-export-btn {
            background: linear-gradient(135deg, #1D428A 0%, #0077C0 100%);
            color: #FFFFFF;
            border: none;
            padding: 15px 25px;
            border-radius: 30px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 10px 25px rgba(29, 66, 138, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .pdf-export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(29, 66, 138, 0.4);
            background: linear-gradient(135deg, #0077C0 0%, #1D428A 100%);
        }

        /* Hide PDF export button on mobile */
        @media (max-width: 768px) {
            .pdf-export-section {
                bottom: 20px;
                right: 20px;
            }

            .pdf-export-btn {
                padding: 12px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <div class="page-container">
        <div class="page">
            <div class="page-content">
            <!-- Title Page -->
            <div class="header">
                <h1 class="title">Thousand-Station Liquid-Cooled Ultra-Fast Charging Project Business Plan</h1>
            </div>

            <!-- Project Overview -->
            <div class="section">
                <h3 class="section-title">1. Project Overview</h3>

                <h4 class="subsection-title">1.1 Project Introduction</h4>
                <p>The Thousand-Station Liquid-Cooled Ultra-Fast Charging Project is a national charging infrastructure network based on Huawei's complete liquid-cooled ultra-fast charging technology, planning to build a comprehensive ultra-fast charging network covering county-level highway exits and commercial complexes in 1000 cities. The project adopts Huawei 600kW-megawatt ultra-fast charging technology, achieving the ultimate charging experience of "one cup of coffee, full charge departure" with charging times reduced to 2-3 minutes, redefining industry service standards.</p>

                <div class="highlight-box">
                    <h4 class="highlight-title">Core Investment Highlights</h4>
                    <ul>
                        <li><strong>Technological Revolution:</strong> Huawei 600kW-megawatt ultra-fast charging technology, exclusive 3-5 year technology dividend period</li>
                        <li><strong>Exceptional Returns:</strong> IRR 24.2%, payback period 4.2 years, significantly higher than industry average</li>
                        <li><strong>Market Explosion:</strong> Based on 2023-2027 CAGR analysis, 2027 NEV ownership is projected to reach 100 million units, representing significant growth from 2023</li>
                        <li><strong>Risk Controlled:</strong> Monte Carlo simulation 84.2% success rate, conservative scenario IRR still at 10.1%</li>
                        <li><strong>Clear Exit Strategy:</strong> REITs listing path clearly defined, achieving asset-light operations within 5 years</li>
                    </ul>
                </div>

                <h4 class="subsection-title">1.2 Key Data</h4>
                <div class="data-grid">
                    <div class="data-card">
                        <div class="data-value">¥2.8 billion</div>
                        <div class="data-label">Total Investment</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">¥2.8 million</div>
                        <div class="data-label">Cost per Station</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">¥100,000</div>
                        <div class="data-label">Government Subsidy/Station</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">24.2%</div>
                        <div class="data-label">Project IRR</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">4.2 years</div>
                        <div class="data-label">Payback Period</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">¥636 million</div>
                        <div class="data-label">Annual Cash Flow</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">28.6%</div>
                        <div class="data-label">EBITDA Margin</div>
                    </div>
                    <div class="data-card">
                        <div class="data-value">84.2%</div>
                        <div class="data-label">Monte Carlo Success Rate</div>
                    </div>
                </div>
            </div>

            <!-- Market Analysis -->
            <div class="section">
                <h3 class="section-title">2. Market Analysis</h3>

                <h4 class="subsection-title">2.1 Industry Background</h4>
                <p>China's new energy vehicle market is experiencing explosive growth. In 2023, NEV ownership reached 20.41 million units, maintaining 50%+ growth for four consecutive years. Based on 2023-2027 CAGR analysis, ownership is projected to reach 100 million units by 2027, providing enormous development space for charging infrastructure.</p>

                <p><strong>Growth Drivers:</strong></p>
                <ul>
                    <li>Breakthroughs in battery technology, improved range</li>
                    <li>Continuous improvement in charging infrastructure</li>
                    <li>Increasing policy support</li>
                    <li>Significant improvement in consumer acceptance</li>
                </ul>

                <div class="chart-container">
                    <h4 class="chart-title">NEV Ownership Growth Trend (2020-2028)</h4>
                    <canvas id="investorMarketGrowthChart" width="600" height="320"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Key Insight:</strong> 2023 NEV ownership reached 20.41 million units, maintaining 50%+ growth for four consecutive years. Based on 2023-2027 CAGR analysis, projected to reach 100 million units by 2027, demonstrating tremendous market potential.
                    </p>
                </div>

                <h4 class="subsection-title">2.2 Market Size</h4>
                <p><strong>Potential Site Analysis:</strong></p>
                <ul>
                    <li>New highway exits by 2027: 240</li>
                    <li>County-level commercial centers (200K+ population): 1,200</li>
                    <li>Total potential sites: 1,440</li>
                </ul>

                <p><strong>Effective Site Screening:</strong></p>
                <ul>
                    <li>Traffic volume screening (>10,000 vehicles/day): 504 sites</li>
                    <li>Grid capacity screening (>630kVA): 504 sites</li>
                    <li>Final deployable sites: 504 sites</li>
                </ul>

                <p><strong>Market Capacity Assessment:</strong></p>
                <ul>
                    <li>Project target share: 1,000 stations</li>
                    <li><strong>Serviceable Market Size:</strong> Based on the 2025 National Development and Reform Commission's "EV Charging Infrastructure Enhancement Action Plan (2025-2027)", China will build 28 million charging facilities to serve 80 million electric vehicles, making the project's 1,000 stations a strategic market share acquisition</li>
                </ul>

                <h4 class="subsection-title">2.3 Competitive Analysis</h4>
                <p><strong>Major Competitor Analysis (2024 Latest Market Data):</strong></p>
                <table>
                    <thead>
                        <tr>
                            <th>Brand</th>
                            <th>Main Product Series</th>
                            <th>Rated Power (kW)</th>
                            <th>Actual Output (kW)</th>
                            <th>Failure Rate</th>
                            <th>Unit Construction Cost (¥/kW)</th>
                            <th>Market Share</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Star Charge</td>
                            <td>BaChong 480/720</td>
                            <td>480-720</td>
                            <td>360-480</td>
                            <td>0.08-0.12%</td>
                            <td>800-1200</td>
                            <td>28.5%</td>
                        </tr>
                        <tr>
                            <td>TELD</td>
                            <td>Group Charging Smart Series</td>
                            <td>360-480</td>
                            <td>320-420</td>
                            <td>0.06-0.10%</td>
                            <td>1000-1400</td>
                            <td>16.8%</td>
                        </tr>
                        <tr>
                            <td>State Grid</td>
                            <td>Highway Smart Charging</td>
                            <td>240-360</td>
                            <td>200-300</td>
                            <td>0.05-0.08%</td>
                            <td>900-1100</td>
                            <td>22.3%</td>
                        </tr>
                        <tr>
                            <td>BYD</td>
                            <td>Denza Charging Network</td>
                            <td>480-600</td>
                            <td>380-480</td>
                            <td>0.07-0.11%</td>
                            <td>950-1350</td>
                            <td>8.2%</td>
                        </tr>
                        <tr>
                            <td>NIO</td>
                            <td>Swap Station 2.0</td>
                            <td>500-750</td>
                            <td>400-600</td>
                            <td>0.05-0.08%</td>
                            <td>1500-2000</td>
                            <td>4.1%</td>
                        </tr>
                        <tr class="highlight-row">
                            <td><strong>This Project</strong></td>
                            <td><strong>Huawei 600kW-Megawatt</strong></td>
                            <td><strong>600-1000kW</strong></td>
                            <td><strong>600-1000kW</strong></td>
                            <td><strong>&lt;0.04%</strong></td>
                            <td><strong>1000</strong></td>
                            <td><strong>Technology Leader</strong></td>
                        </tr>
                    </tbody>
                </table>

                <p><strong>Competitive Advantage Quantification:</strong></p>
                <ul>
                    <li><strong>Megawatt Technology:</strong> 600kW-1000kW+, compared to Star Charge's 480kW (best among competitors), 25-100%+ performance improvement</li>
                    <li><strong>Actual Output Efficiency:</strong> 100% power output, industry average 75-85%, 15-25% improvement</li>
                    <li><strong>Equipment Reliability:</strong> &lt;0.04% failure rate, surpassing Tesla's 0.04-0.07% best performance</li>
                    <li><strong>Charging Speed:</strong> 2-5 minutes for full charge, industry average 20-40 minutes, 85-95% improvement</li>
                    <li><strong>Service Capacity:</strong> 15-20 vehicles/gun/day, industry average 6-8 vehicles/gun/day, 150%+ improvement</li>
                </ul>
            </div>

            <!-- Technical Solution -->
            <div class="section">
                <h3 class="section-title">3. Technical Solution</h3>

                <h4 class="subsection-title">3.1 Huawei Megawatt Ultra-Fast Charging Technology</h4>
                <p><strong>Megawatt Technology Breakthrough:</strong> Huawei has completed the R&D and commercialization preparation for megawatt (1000kW+) charging technology, providing exclusive technological advantages for the project.</p>

                <table>
                    <thead>
                        <tr>
                            <th>Technical Parameter</th>
                            <th>Current 600kW Stage</th>
                            <th>Megawatt 1000kW+ Stage</th>
                            <th>Technical Advantage</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Charging Power</td>
                            <td>600kW</td>
                            <td>1000kW+</td>
                            <td>Megawatt power breakthrough</td>
                        </tr>
                        <tr>
                            <td>Charging Time</td>
                            <td>5 minutes</td>
                            <td>2-3 minutes</td>
                            <td>60% time savings</td>
                        </tr>
                        <tr>
                            <td>Cooling Efficiency</td>
                            <td>+300% vs air cooling</td>
                            <td>Supports megawatt cooling</td>
                            <td>Full-stack liquid cooling technology</td>
                        </tr>
                        <tr>
                            <td>Operating Noise</td>
                            <td>&lt;55dB</td>
                            <td>&lt;60dB</td>
                            <td>Megawatt still quiet</td>
                        </tr>
                        <tr>
                            <td>Equipment Failure Rate</td>
                            <td>&lt;0.04%</td>
                            <td>&lt;0.04%</td>
                            <td>Industry highest standard</td>
                        </tr>
                        <tr>
                            <td>Conversion Efficiency</td>
                            <td>&gt;96%</td>
                            <td>&gt;96%</td>
                            <td>Power factor &gt;0.99</td>
                        </tr>
                        <tr>
                            <td>Footprint</td>
                            <td>50% space saving</td>
                            <td>50% space saving</td>
                            <td>Highest megawatt unit efficiency</td>
                        </tr>
                    </tbody>
                </table>

                <div class="chart-container">
                    <h4 class="chart-title">Huawei Megawatt Ultra-Fast Charging Technology Three-Tier System Architecture</h4>
                    <canvas id="huaweiMegaArchitectureChart" width="600" height="320"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Technical Architecture Analysis:</strong> Cloud management platform implements big data analytics, intelligent scheduling and remote monitoring; station management system handles local equipment management, power distribution and safety protection; charging equipment layer provides 600kW-1000kW+ megawatt power output, supporting full-stack liquid cooling.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Power System Architecture</h4>
                    <canvas id="powerSystemChart" width="500" height="260"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Intelligent Power Distribution:</strong> Adopts 10kV dual-circuit power supply, configured with 2000kVA transformer, dynamically adjusts output of each charging pile through intelligent power distribution modules.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Liquid Cooling System Principles</h4>
                    <canvas id="coolingSystemChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Full Liquid Cooling Technology:</strong> Adopts circulating coolant system, cooling efficiency 300% higher than traditional air cooling. System operating temperature -40~65℃, coolant flow 20L/min.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Charging Station Layout</h4>
                    <canvas id="stationLayoutChart" width="500" height="280"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Standardized Station Design:</strong> Single station covers 1000m², layouts 12 600kW ultra-fast charging piles in 4×3 grid layout, ensuring convenient vehicle access.
                    </p>
                </div>
            </div>

            <!-- Financial Analysis -->
            <div class="section">
                <h3 class="section-title">4. Financial Analysis</h3>

                <h4 class="subsection-title">4.1 Investment Structure</h4>
                <ul>
                    <li><strong>Total Investment:</strong> ¥2.8 billion</li>
                    <li><strong>Investment per Station:</strong> ¥2.8 million</li>
                    <li><strong>Government Subsidy:</strong> ¥100,000 per station</li>
                    <li><strong>Net Investment per Station:</strong> ¥2.7 million</li>
                    <li><strong>Construction Scale:</strong> 1000 Huawei 600kW liquid-cooled ultra-fast charging stations</li>
                    <li><strong>Project Duration:</strong> 10 years</li>
                </ul>

                <div class="chart-container">
                    <h4 class="chart-title">Investment Return Dashboard</h4>
                    <canvas id="investmentReturnDashboard" width="600" height="320"></canvas>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Monte Carlo Simulation Results</h4>
                    <canvas id="monteCarloSimulationChart" width="600" height="340"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Simulation Analysis:</strong> Based on 1000 Monte Carlo iterations, project IRR shows normal distribution with peak concentration in 20-30% range. 84.2% probability of achieving returns exceeding cost of capital.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Annual Cash Flow Analysis</h4>
                    <canvas id="investorCashFlowChart" width="600" height="320"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Cash Flow Characteristics:</strong> Initial investment of ¥2.7 billion, showing realistic fluctuation patterns. Cumulative cash flow turns positive in Year 5 (¥334 million), payback period 4.1 years.
                    </p>
                    <p style="margin-top: 10px; font-size: 12px; line-height: 1.5; color: #9CA3AF;">
                        <strong>Cumulative Cash Flow Key Milestones:</strong> Year 0 (-27.0) → Year 3 (-9.55) → Year 5 (3.34, break-even) → Year 7 (16.98) → Year 10 (36.60)
                    </p>
                </div>

                <!-- Detailed Financial Analysis -->
                <div style="margin: 20px 0;">
                    <h4 style="color: #1D428A; margin-bottom: 15px; font-size: 16px;">💰 Detailed Financial Analysis</h4>

                    <!-- Cash Flow Logic Analysis Table -->
                    <table style="width: 100%; border-collapse: collapse; margin: 15px 0; background: rgba(255,255,255,0.05); border-radius: 8px; overflow: hidden;">
                        <thead>
                            <tr style="background: rgba(29,66,138,0.8); color: white;">
                                <th style="padding: 12px 8px; font-size: 13px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Phase</th>
                                <th style="padding: 12px 8px; font-size: 13px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year</th>
                                <th style="padding: 12px 8px; font-size: 13px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Cash Flow (¥100M)</th>
                                <th style="padding: 12px 8px; font-size: 13px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Relative to Baseline</th>
                                <th style="padding: 12px 8px; font-size: 13px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Driving Factors</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr style="background: rgba(255,243,0,0.1);">
                                <td rowspan="2" style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
                                    <span style="display: inline-block; padding: 2px 6px; border-radius: 8px; font-size: 11px; font-weight: bold; background: #ffc107; color: #212529;">Ramp-up</span>
                                </td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 1</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">4.85</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">76%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">User awareness building</td>
                            </tr>
                            <tr style="background: rgba(255,243,0,0.1);">
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 2</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">5.98</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">94%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Network effects emerging</td>
                            </tr>
                            <tr>
                                <td rowspan="3" style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
                                    <span style="display: inline-block; padding: 2px 6px; border-radius: 8px; font-size: 11px; font-weight: bold; background: #17a2b8; color: white;">Stable</span>
                                </td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 3</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.62</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">104%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Operational efficiency</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 4</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.51</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">102%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Seasonal factors</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 5</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.38</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">100%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Tech upgrade preparation</td>
                            </tr>
                            <tr style="background: rgba(40,167,69,0.1);">
                                <td rowspan="2" style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
                                    <span style="display: inline-block; padding: 2px 6px; border-radius: 8px; font-size: 11px; font-weight: bold; background: #28a745; color: white;">Tech Dividend</span>
                                </td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 6</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.75</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">106%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Megawatt tech upgrade</td>
                            </tr>
                            <tr style="background: rgba(40,167,69,0.1);">
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 7</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);"><strong>6.89</strong></td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);"><strong>108%</strong></td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Tech advantage maximized</td>
                            </tr>
                            <tr>
                                <td rowspan="3" style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">
                                    <span style="display: inline-block; padding: 2px 6px; border-radius: 8px; font-size: 11px; font-weight: bold; background: #6f42c1; color: white;">Mature</span>
                                </td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 8</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.72</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">106%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Market competition</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 9</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.48</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">102%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Operational optimization</td>
                            </tr>
                            <tr>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">Year 10</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">6.42</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1);">101%</td>
                                <td style="padding: 10px 8px; text-align: center; border: 1px solid rgba(255,255,255,0.1); font-size: 12px;">Equipment aging effects</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- Financial Indicators Summary -->
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 12px; margin: 20px 0;">
                        <div style="background: rgba(29,66,138,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 1px solid rgba(29,66,138,0.3);">
                            <div style="font-size: 13px; color: #B8C5E0; margin-bottom: 5px;">10-Year Cash Flow Total</div>
                            <div style="font-size: 18px; font-weight: bold; color: #1D428A;">¥6.36 billion</div>
                        </div>
                        <div style="background: rgba(29,66,138,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 1px solid rgba(29,66,138,0.3);">
                            <div style="font-size: 13px; color: #B8C5E0; margin-bottom: 5px;">Payback Period</div>
                            <div style="font-size: 18px; font-weight: bold; color: #1D428A;">4.1 Years</div>
                        </div>
                        <div style="background: rgba(29,66,138,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 1px solid rgba(29,66,138,0.3);">
                            <div style="font-size: 13px; color: #B8C5E0; margin-bottom: 5px;">Peak Cash Flow</div>
                            <div style="font-size: 18px; font-weight: bold; color: #1D428A;">¥689 million</div>
                            <small>Year 7</small>
                        </div>
                        <div style="background: rgba(29,66,138,0.1); padding: 15px; border-radius: 8px; text-align: center; border: 1px solid rgba(29,66,138,0.3);">
                            <div style="font-size: 13px; color: #B8C5E0; margin-bottom: 5px;">Cumulative Cash Flow</div>
                            <div style="font-size: 18px; font-weight: bold; color: #1D428A;">¥3.66 billion</div>
                        </div>
                    </div>

                    <p style="margin-top: 15px; font-size: 12px; line-height: 1.5; color: #9CA3AF;">
                        <strong>Key Financial Insights:</strong> The fluctuation model demonstrates typical characteristics of technology-driven projects: relatively lower cash flow in early ramp-up phase, with significant improvement through Huawei megawatt technology upgrade, peaking at ¥689 million in Year 7. The fluctuation model better reflects realistic business development paths and investment value.
                    </p>
                </div>

                <div class="chart-container">
                    <h4 class="chart-title">Return on Investment Analysis</h4>
                    <canvas id="investorROIChart" width="600" height="320"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Comparative Advantage Analysis:</strong> This project's base IRR of 24.2% significantly exceeds traditional charging infrastructure (15-18%) and highway REITs (6-8%).
                    </p>
                </div>
            </div>

            <!-- Risk Assessment -->
            <div class="section">
                <h3 class="section-title">5. Risk Assessment</h3>

                <div class="chart-container">
                    <h4 class="chart-title">Risk Factor Sensitivity Analysis</h4>
                    <canvas id="riskSensitivityChart" width="600" height="320"></canvas>
                    <p style="margin-top: 15px; font-size: 13px; line-height: 1.6; color: #B8C5E0;">
                        <strong>Key Risk Identification:</strong> Competition intensification is the biggest risk factor, potentially causing IRR to decline by 15 percentage points; utilization rate changes have significant impact.
                    </p>
                </div>

                <h4 class="subsection-title">5.1 Risk Identification</h4>
                <div class="key-metrics">
                    <div class="metric-card">
                        <div class="metric-value">Low</div>
                        <div class="metric-label">Technical Risk</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">Medium</div>
                        <div class="metric-label">Market Risk</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">Medium</div>
                        <div class="metric-label">Policy Risk</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">Low</div>
                        <div class="metric-label">Financial Risk</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-value">Low</div>
                        <div class="metric-label">Operational Risk</div>
                    </div>
                </div>

                <h4 class="subsection-title">5.2 Risk Mitigation Measures</h4>
                <ul>
                    <li><strong>Technical Risk:</strong> Huawei 15-year warranty, regular maintenance, spare parts inventory</li>
                    <li><strong>Market Risk:</strong> Long-term power purchase agreements, diversified customer base</li>
                    <li><strong>Policy Risk:</strong> Government relations management, policy change monitoring</li>
                    <li><strong>Financial Risk:</strong> Conservative financing structure, multiple funding sources</li>
                    <li><strong>Operational Risk:</strong> Professional operations team, 24/7 monitoring system</li>
                </ul>
            </div>

            <!-- Implementation Plan -->
            <div class="section">
                <h3 class="section-title">6. Implementation Plan</h3>

                <h4 class="subsection-title">6.1 Phased Implementation Strategy</h4>
                <p><strong>Phase 1: Pilot Validation (2025)</strong></p>
                <ul>
                    <li>Target: Build 100 ultra-fast charging stations</li>
                    <li>Focus: Tier-1 city commercial areas, highway service areas</li>
                    <li>Goal: Complete technology validation and business model testing</li>
                </ul>

                <p><strong>Phase 2: Scale Expansion (2026-2027)</strong></p>
                <ul>
                    <li>Target: Add 400 stations</li>
                    <li>Focus: Provincial capitals, major highway networks</li>
                    <li>Goal: Form network effects and brand influence</li>
                </ul>

                <p><strong>Phase 3: National Layout (2028)</strong></p>
                <ul>
                    <li>Target: Add 300 stations</li>
                    <li>Focus: Tier-3 and Tier-4 cities, county-level coverage</li>
                    <li>Goal: Achieve national coverage</li>
                </ul>

                <p><strong>Phase 4: Optimization Enhancement (2029)</strong></p>
                <ul>
                    <li>Target: Add 200 stations</li>
                    <li>Focus: Network density optimization, service quality improvement</li>
                    <li>Goal: Perfect network layout and operational efficiency</li>
                </ul>
            </div>

            <!-- Investment Recommendation -->
            <div class="section">
                <h3 class="section-title">7. Investment Recommendation</h3>

                <div class="conclusion">
                    <h3 class="conclusion-title">⭐⭐⭐⭐⭐ Strongly Recommended</h3>

                    <h4>Key Investment Highlights:</h4>
                    <ol>
                        <li><strong>Technology Leadership:</strong> Huawei's megawatt ultra-fast charging technology leads the industry with exclusive 3-5 year technology dividend period</li>
                        <li><strong>Large Market Opportunity:</strong> Based on the 2025 National Development and Reform Commission's "EV Charging Infrastructure Enhancement Action Plan (2025-2027)", China will build 28 million charging facilities to serve 80 million electric vehicles</li>
                        <li><strong>Excellent Financial Returns:</strong> IRR 24.2%, 4.2-year payback, NPV@10% ¥870 million</li>
                        <li><strong>Strong Policy Support:</strong> County-level ultra-fast charging demonstration projects, ¥100,000 per station subsidy</li>
                        <li><strong>Controlled Risk:</strong> Extremely low technical risk, Monte Carlo simulation success rate 84.2%</li>
                    </ol>

                    <h4>Suitable Investors:</h4>
                    <ul>
                        <li><strong>Strategic Investors:</strong> Optimistic about long-term new energy development</li>
                        <li><strong>Financial Investors:</strong> Professional investment institutions pursuing high returns</li>
                        <li><strong>Industry Investors:</strong> New energy vehicle industry chain related enterprises</li>
                        <li><strong>Government Funds:</strong> Government guidance funds supporting new energy development</li>
                    </ul>
                </div>
            </div>
            </div>
        </div>
    <!-- PDF Export Button -->
    <div class="pdf-export-section">
        <button class="pdf-export-btn" onclick="exportToPDF()">
            📄 Export to PDF
        </button>
    </div>

    <script>
        // PDF Export Function
        function exportToPDF() {
            window.print();
        }

        // Chart Rendering Functions (Based on Chinese Source File)

        // Market Growth Chart Function
        function renderInvestorMarketGrowthChart() {
            const canvas = document.getElementById('investorMarketGrowthChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 600);
            const height = 320;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Data (Updated with actual public data)
            const years = ['2020', '2021', '2022', '2023', '2024', '2025', '2026', '2027', '2028'];
            const salesData = [137, 352, 679, 950, 1400, 1820, 2370, 3080, 4000]; // 2020-2024 actual data, 2025+ forecast
            const penetrationData = [5.4, 13.4, 25.6, 31.6, 47.5, 58.2, 68.5, 76.3, 82.1]; // Penetration rate based on ownership

            // Set styles - matching dark theme
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                accent: '#FFC72C',
                text: '#B8C5E0',
                bg: '#0A0E27'
            };

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Draw axes
            ctx.strokeStyle = 'rgba(0, 0, 0, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(60, height - 60);
            ctx.lineTo(width - 40, height - 60);
            ctx.moveTo(60, 30);
            ctx.lineTo(60, height - 60);
            ctx.stroke();

            // Draw sales curve (left axis)
            ctx.strokeStyle = colors.primary;
            ctx.lineWidth = 3;
            ctx.beginPath();

            const maxSales = Math.max(...salesData);
            const salesScale = (height - 100) / maxSales;

            salesData.forEach((value, index) => {
                const x = 60 + (index * (width - 120) / (years.length - 1));
                const y = height - 60 - value * salesScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // Draw data points
                ctx.fillStyle = colors.primary;
                ctx.beginPath();
                ctx.arc(x, y, 4, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // Draw penetration curve (right axis)
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.beginPath();

            const maxPenetration = Math.max(...penetrationData);
            const penetrationScale = (height - 100) / maxPenetration;

            penetrationData.forEach((value, index) => {
                const x = 60 + (index * (width - 120) / (years.length - 1));
                const y = height - 60 - value * penetrationScale;

                if (index === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }

                // Draw data points
                ctx.fillStyle = colors.success;
                ctx.beginPath();
                ctx.arc(x, y, 3, 0, 2 * Math.PI);
                ctx.fill();
            });
            ctx.stroke();

            // Draw labels
            ctx.fillStyle = '#333';
            ctx.font = '11px Arial';
            ctx.textAlign = 'center';

            // X-axis labels
            years.forEach((year, index) => {
                const x = 60 + (index * (width - 120) / (years.length - 1));
                ctx.fillText(year, x, height - 45);
            });

            // Y-axis labels
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = (maxSales * i / 5).toFixed(0);
                const y = height - 60 - (height - 100) * i / 5;
                ctx.fillText(value + '万', 50, y + 3);
            }

            // Legend
            ctx.fillStyle = colors.primary;
            ctx.fillRect(width - 180, 10, 15, 3);
            ctx.fillStyle = '#333';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Sales (10K units)', width - 160, 14);

            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 180, 25, 15, 3);
            ctx.fillText('Penetration (%)', width - 160, 29);
        }

        // Gauge drawing helper function
        function drawGauge(ctx, x, y, radius, value, maxValue, label, unit, color, isInvert = false) {
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                warning: '#F59E0B',
                danger: '#EF4444',
                accent: '#FFC72C',
                text: '#374151',
                bg: '#B8C5E0'
            };
            // Background arc
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.2)';
            ctx.lineWidth = 8;
            ctx.beginPath();
            ctx.arc(x, y, radius, Math.PI * 0.7, Math.PI * 2.3, false);
            ctx.stroke();
            // Value arc
            const percentage = Math.min(value / maxValue, 1);
            const endAngle = Math.PI * 0.7 + (Math.PI * 1.6 * percentage);
            ctx.strokeStyle = color;
            ctx.lineWidth = 8;
            ctx.beginPath();
            ctx.arc(x, y, radius, Math.PI * 0.7, endAngle, false);
            ctx.stroke();
            // Center value
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 18px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText(value.toFixed(1), x, y + 5);
            // Label
            ctx.font = '11px Arial, sans-serif';
            ctx.fillText(label, x, y + 25);
            // Unit
            ctx.font = '10px Arial, sans-serif';
            ctx.globalAlpha = 0.7;
            ctx.fillText(unit, x, y - 20);
            ctx.globalAlpha = 1;
        }

        // Investment Return Dashboard Function (Based on Chinese Source)
        function renderInvestmentReturnDashboard() {
            const canvas = document.getElementById('investmentReturnDashboard');
            if (!canvas) return;
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            // Set high resolution support
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            canvas.style.width = rect.width + 'px';
            canvas.style.height = rect.height + 'px';
            const width = rect.width;
            const height = rect.height;
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            // Set styles - matching dark theme
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                warning: '#F59E0B',
                danger: '#EF4444',
                accent: '#FFC72C',
                text: '#374151',
                bg: '#B8C5E0'
            };
            // Draw background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);
            // Title
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 16px Arial, sans-serif';
            ctx.textAlign = 'center';
            // Dashboard area layout
            const gaugeY = 60;
            const gaugeRadius = 45;
            const gaugeSpacing = width / 4;
            // 1. IRR gauge
            const irrX = gaugeSpacing;
            const irrValue = 24.2;
            drawGauge(ctx, irrX, gaugeY, gaugeRadius, irrValue, 40, 'IRR', '%', colors.primary);
            // 2. Payback period gauge
            const paybackX = gaugeSpacing * 2;
            const paybackValue = 4.2;
            drawGauge(ctx, paybackX, gaugeY, gaugeRadius, paybackValue, 10, 'Payback', 'Years', colors.success, true);
            // 3. ROI gauge
            const roiX = gaugeSpacing * 3;
            const roiValue = 43.9;
            drawGauge(ctx, roiX, gaugeY, gaugeRadius, roiValue, 60, 'ROI', '%', colors.accent);
            // Key metrics area
            const metricsY = 160;
            const metrics = [
                { label: 'Total Investment', value: '¥2.8 billion', color: colors.primary },
                { label: 'NPV@10%', value: '¥0.87 billion', color: colors.success },
                { label: 'Annual Revenue', value: '¥2.05 billion', color: colors.secondary },
                { label: 'EBITDA Margin', value: '28.6%', color: colors.warning }
            ];
            ctx.font = '12px Arial, sans-serif';
            ctx.textAlign = 'left';
            metrics.forEach((metric, index) => {
                const x = 20 + (index % 2) * (width / 2 - 40);
                const y = metricsY + Math.floor(index / 2) * 25;
                // Metric label
                ctx.fillStyle = colors.text;
                ctx.globalAlpha = 0.8;
                ctx.fillText(metric.label, x, y);
                // Metric value
                ctx.fillStyle = metric.color;
                ctx.globalAlpha = 1;
                ctx.font = 'bold 13px Arial, sans-serif';
                ctx.fillText(metric.value, x + 120, y);
                ctx.font = '12px Arial, sans-serif';
            });
            // Draw investment return curve
            const chartY = 240;
            const chartHeight = 60;
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, chartY);
            ctx.lineTo(width - 30, chartY);
            ctx.stroke();
            // Draw cumulative return curve
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.beginPath();
            const years = 10;
            for (let i = 0; i <= years; i++) {
                const x = 50 + (i / years) * (width - 80);
                const value = Math.pow(1.242, i) - 1; // Compound growth
                const y = chartY - (value * chartHeight / 10);
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();
            // Add chart labels
            ctx.fillStyle = colors.text;
            ctx.font = '10px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Investment Return Curve (10-Year IRR: 24.2%)', width / 2, height - 5);
            ctx.globalAlpha = 1;
        }

        // Monte Carlo Simulation Function (Based on Chinese Source)
        function renderMonteCarloSimulationChart() {
            const canvas = document.getElementById('monteCarloSimulationChart');
            if (!canvas) {
                console.log('Monte Carlo canvas not found');
                return;
            }
            console.log('Rendering Monte Carlo chart...');
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            // Simple dimensions for testing
            const width = 600;
            const height = 340;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                warning: '#F59E0B',
                danger: '#EF4444',
                accent: '#FFC72C',
                text: '#374151',
                bg: '#B8C5E0'
            };

            // Draw background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Title
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 14px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('IRR Probability Distribution Simulation (1000 Iterations)', width / 2, 20);

            // IRR distribution data
            const irrRanges = [
                { range: '5-10%', count: 25, color: colors.danger },
                { range: '10-15%', count: 85, color: colors.warning },
                { range: '15-20%', count: 180, color: colors.accent },
                { range: '20-25%', count: 280, color: colors.success },
                { range: '25-30%', count: 220, color: colors.success },
                { range: '30-35%', count: 120, color: colors.primary },
                { range: '35-40%', count: 60, color: colors.primary },
                { range: '40%+', count: 30, color: colors.secondary }
            ];

            const maxCount = Math.max(...irrRanges.map(r => r.count));
            const barWidth = (width - 80) / irrRanges.length;
            const chartHeight = height - 80;

            // Draw axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(50, height - 40);
            ctx.lineTo(50, 40);
            ctx.stroke();

            // Draw bars
            irrRanges.forEach((data, index) => {
                const x = 55 + index * barWidth;
                const barHeight = (data.count / maxCount) * chartHeight;
                const y = height - 40 - barHeight;

                // Draw bar
                ctx.fillStyle = data.color;
                ctx.globalAlpha = 0.8;
                ctx.fillRect(x, y, barWidth - 10, barHeight);

                // Draw value
                ctx.fillStyle = colors.text;
                ctx.globalAlpha = 1;
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(data.count, x + (barWidth - 10) / 2, y - 5);

                // Draw range label
                ctx.fillStyle = colors.text;
                ctx.font = '9px Arial';
                ctx.fillText(data.range, x + (barWidth - 10) / 2, height - 25);
            });

            // Draw Y-axis labels
            ctx.fillStyle = colors.text;
            ctx.font = '9px Arial';
            ctx.textAlign = 'right';
            for (let i = 0; i <= 5; i++) {
                const value = (maxCount * i / 5).toFixed(0);
                const y = height - 40 - (chartHeight * i / 5);
                ctx.fillText(value, 45, y + 3);
            }

            // Draw probability percentage
            ctx.globalAlpha = 1;
            irrRanges.forEach((data, index) => {
                const x = 55 + index * barWidth;
                const percentage = (data.count / 1000 * 100).toFixed(1);
                ctx.fillStyle = colors.text;
                ctx.font = '8px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(percentage + '%', x + (barWidth - 10) / 2, height - 12);
            });

            // Add success rate annotation
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Success Rate: 84.2% (IRR > 10%)', width / 2, height - 15);

            // Add expected IRR annotation
            ctx.fillStyle = colors.accent;
            ctx.font = 'bold 11px Arial';
            ctx.fillText('Expected IRR: 24.2%', width / 2, 35);

            console.log('Monte Carlo chart rendering completed');
        }

        // Cash Flow Chart Function
        function renderInvestorCashFlowChart() {
            const canvas = document.getElementById('investorCashFlowChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // Limit max width
            const height = 280;
            canvas.width = width;
            canvas.height = height;
            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Data (based on realistic cash flow model, maintaining 10-year total of ¥63.6 billion)
            const years = ['Y0', 'Y1', 'Y2', 'Y3', 'Y4', 'Y5', 'Y6', 'Y7', 'Y8', 'Y9', 'Y10'];
            // Cash flow model considering ramp-up, technology upgrades, market competition
            const cashFlowData = [
                -27.0,  // Y0: Initial investment (¥ billion)
                4.85,  // Y1: Ramp-up period (76% of baseline) - gradual station deployment
                5.98,  // Y2: Rapid growth (94% of baseline) - network effects taking hold
                6.62,  // Y3: Early stability (104% of baseline) - operational efficiency
                6.51,  // Y4: Stable period (102% of baseline) - seasonal factors
                6.38,  // Y5: Pre-tech upgrade (100% of baseline) - Huawei megawatt upgrade prep
                6.75,  // Y6: Tech upgrade (106% of baseline) - megawatt efficiency gains
                6.89,  // Y7: Tech dividend (108% of baseline) - megawatt advantage maximized
                6.72,  // Y8: Competition period (106% of baseline) - market competition with tech edge
                6.48,  // Y9: Mature period (102% of baseline) - market saturation, optimization
                6.42   // Y10: Late adjustment (101% of baseline) - aging, maintenance costs
            ];
            // Set styles
            const colors = {
                primary: '#1D428A',
                success: '#10B981',
                danger: '#EF4444'
            };
            // Draw axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(50, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(50, 20);
            ctx.lineTo(50, height - 40);
            ctx.stroke();
            // Draw cash flow bars
            const barWidth = (width - 100) / years.length * 0.6;
            const scale = (height - 80) / 35; // Adjust scale for annual cash flow (-30 to +10)

            // Calculate zero line position
            const zeroY = height - 40 - ((0 + 30) * scale); // Position for Y=0

            cashFlowData.forEach((value, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length - barWidth) / 2;
                const barHeight = Math.abs(value) * scale; // Data already in same scale as Chinese version

                // Position bars relative to zero line
                let y, barY;
                if (value >= 0) {
                    // Positive values: bar extends upward from zero line
                    barY = zeroY - barHeight;
                    y = barY; // Label position above bar
                } else {
                    // Negative values: bar extends downward from zero line
                    barY = zeroY;
                    y = zeroY + barHeight + 15; // Label position below bar
                }

                ctx.fillStyle = value >= 0 ? colors.success : colors.danger;
                ctx.fillRect(x, barY, barWidth, barHeight);

                // Draw value labels
                ctx.fillStyle = '#374151';
                ctx.font = '9px Arial, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value.toFixed(1), x + barWidth / 2, y);
            });

            // Draw Y-axis labels
            ctx.fillStyle = '#6b7280';
            ctx.font = '9px Arial, sans-serif';
            ctx.textAlign = 'right';
            for (let i = -30; i <= 10; i += 5) {
                const y = height - 40 - ((i + 30) * scale);
                ctx.fillText(i.toFixed(0), 45, y + 3);
                // Draw grid lines
                if (i !== 0 && i !== -30) {
                    ctx.strokeStyle = '#e5e7eb';
                    ctx.lineWidth = 0.5;
                    ctx.beginPath();
                    ctx.moveTo(50, y);
                    ctx.lineTo(width - 30, y);
                    ctx.stroke();
                }
            }

            // Draw zero line (emphasized)
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(50, zeroY);
            ctx.lineTo(width - 30, zeroY);
            ctx.stroke();
            // Draw X-axis labels
            ctx.fillStyle = '#6b7280';
            ctx.font = '9px Arial, sans-serif';
            ctx.textAlign = 'center';
            years.forEach((year, index) => {
                const x = 50 + (index * (width - 100) / years.length) + ((width - 100) / years.length) / 2;
                ctx.fillText(year, x, height - 25);
            });
            // Add title
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 12px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Annual Cash Flow Analysis (¥100M)', width / 2, 15);
        }

        // ROI Chart Function
        function renderInvestorROIChart() {
            const canvas = document.getElementById('investorROIChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500); // Limit max width
            const height = 280;
            canvas.width = width;
            canvas.height = height;
            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Data
            const scenarios = ['Conservative', 'Base', 'Optimistic'];
            const irrData = [10.1, 24.2, 58.3];
            const multipleData = [8.5, 13.5, 21.8];
            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C'
            };
            // Draw axes
            ctx.strokeStyle = '#e5e7eb';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(60, height - 40);
            ctx.lineTo(width - 30, height - 40);
            ctx.moveTo(60, 20);
            ctx.lineTo(60, height - 40);
            ctx.stroke();
            // Draw IRR bars
            const barWidth = 80;
            const spacing = (width - 120) / scenarios.length;
            const irrScale = (height - 80) / 60;
            irrData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - barWidth / 2;
                const barHeight = value * irrScale;
                const y = height - 40 - barHeight;
                // Gradient fill
                const gradient = ctx.createLinearGradient(0, y, 0, height - 40);
                gradient.addColorStop(0, colors.primary);
                gradient.addColorStop(1, colors.secondary);
                ctx.fillStyle = gradient;
                ctx.fillRect(x, y, barWidth, barHeight);
                // Draw value labels
                ctx.fillStyle = '#374151';
                ctx.font = 'bold 14px Arial, sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(value + '%', x + barWidth / 2, y - 5);
                // Draw scenario labels
                ctx.fillStyle = '#6b7280';
                ctx.font = '11px Arial, sans-serif';
                ctx.fillText(scenarios[index], x + barWidth / 2, height - 25);
            });
            // Add title
            ctx.fillStyle = '#374151';
            ctx.font = 'bold 14px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Internal Rate of Return (IRR) Analysis', width / 2, 15);
            // Draw return multiple indicators
            const multipleY = height - 70;
            ctx.font = '11px Arial, sans-serif';
            ctx.textAlign = 'left';
            multipleData.forEach((value, index) => {
                const x = 60 + spacing * index + spacing / 2 - 30;
                ctx.fillStyle = colors.accent;
                ctx.fillText(`${value}x`, x, multipleY);
            });
        }

        // Risk Sensitivity Analysis Chart Function (Based on Chinese Source)
        function renderRiskSensitivityChart() {
            const canvas = document.getElementById('riskSensitivityChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            // Set high resolution support
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            canvas.style.width = rect.width + 'px';
            canvas.style.height = rect.height + 'px';
            const width = rect.width;
            const height = rect.height;
            // Clear canvas
            ctx.clearRect(0, 0, width, height);
            // Set styles - matching dark theme
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                success: '#10B981',
                warning: '#F59E0B',
                danger: '#EF4444',
                accent: '#FFC72C',
                text: '#374151',
                bg: '#B8C5E0'
            };
            // Draw background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);
            // Title
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 14px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Key Risk Factors Sensitivity Analysis', width / 2, 20);
            // Risk factor data
            const riskFactors = [
                {
                    name: 'Utilization Change',
                    baseImpact: 0,
                    negImpact: -12,
                    posImpact: 15,
                    riskLevel: 'medium'
                },
                {
                    name: 'Electricity Price',
                    baseImpact: 0,
                    negImpact: -8,
                    posImpact: 6,
                    riskLevel: 'medium'
                },
                {
                    name: 'Equipment Cost',
                    baseImpact: 0,
                    negImpact: 10,
                    posImpact: -9,
                    riskLevel: 'low'
                },
                {
                    name: 'Competition Intensification',
                    baseImpact: 0,
                    negImpact: -15,
                    posImpact: 3,
                    riskLevel: 'high'
                },
                {
                    name: 'Policy Support',
                    baseImpact: 0,
                    negImpact: -6,
                    posImpact: 12,
                    riskLevel: 'low'
                }
            ];
            const chartHeight = height - 80;
            const chartY = height - 40;
            const zeroY = chartY - chartHeight / 2;
            const barSpacing = (width - 120) / riskFactors.length;
            // Draw axes
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
            ctx.lineWidth = 1;
            ctx.beginPath();
            ctx.moveTo(60, chartY);
            ctx.lineTo(width - 40, chartY);
            ctx.moveTo(60, chartY);
            ctx.lineTo(60, 40);
            ctx.stroke();
            // Draw zero axis line
            ctx.strokeStyle = colors.text;
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.moveTo(60, zeroY);
            ctx.lineTo(width - 40, zeroY);
            ctx.stroke();
            // Draw Tornado chart
            riskFactors.forEach((factor, index) => {
                const centerX = 90 + index * barSpacing;
                // Get colors
                let negColor = colors.warning;
                let posColor = colors.success;
                if (factor.riskLevel === 'high') {
                    negColor = colors.danger;
                } else if (factor.riskLevel === 'low') {
                    negColor = colors.accent;
                }
                // Draw negative impact bar
                if (factor.negImpact !== 0) {
                    const negHeight = Math.abs(factor.negImpact) * chartHeight / 30;
                    const negY = factor.negImpact < 0 ? zeroY : zeroY - negHeight;
                    ctx.fillStyle = negColor;
                    ctx.globalAlpha = 0.8;
                    ctx.fillRect(centerX - 30, negY, 28, negHeight);
                }
                // Draw positive impact bar
                if (factor.posImpact !== 0) {
                    const posHeight = Math.abs(factor.posImpact) * chartHeight / 30;
                    const posY = factor.posImpact > 0 ? zeroY - posHeight : zeroY;
                    ctx.fillStyle = posColor;
                    ctx.globalAlpha = 0.8;
                    ctx.fillRect(centerX + 2, posY, 28, posHeight);
                }
                // Draw risk factor label
                ctx.fillStyle = colors.text;
                ctx.globalAlpha = 1;
                ctx.font = '10px Arial, sans-serif';
                ctx.textAlign = 'center';
                ctx.save();
                ctx.translate(centerX, zeroY + 5);
                ctx.rotate(-Math.PI / 4);
                ctx.textAlign = 'right';
                ctx.fillText(factor.name, 0, 0);
                ctx.restore();
                // Draw value labels
                ctx.font = '9px Arial, sans-serif';
                if (factor.negImpact !== 0) {
                    ctx.fillStyle = negColor;
                    ctx.textAlign = 'center';
                    const negLabelY = factor.negImpact < 0 ? zeroY + 15 : zeroY - Math.abs(factor.negImpact) * chartHeight / 30 - 5;
                    ctx.fillText(`${factor.negImpact > 0 ? '+' : ''}${factor.negImpact}%`, centerX - 16, negLabelY);
                }
                if (factor.posImpact !== 0) {
                    ctx.fillStyle = posColor;
                    ctx.textAlign = 'center';
                    const posLabelY = factor.posImpact > 0 ? zeroY - Math.abs(factor.posImpact) * chartHeight / 30 - 5 : zeroY + 15;
                    ctx.fillText(`${factor.posImpact > 0 ? '+' : ''}${factor.posImpact}%`, centerX + 16, posLabelY);
                }
            });
            // Draw X-axis label
            ctx.fillStyle = colors.text;
            ctx.font = '10px Arial, sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('IRR Change Range (%)', width / 2, height - 5);
            // Legend
            ctx.font = '9px Arial, sans-serif';
            ctx.textAlign = 'left';
            // Negative impact legend
            ctx.fillStyle = colors.danger;
            ctx.fillRect(width - 120, 45, 12, 10);
            ctx.fillStyle = colors.text;
            ctx.fillText('High Risk', width - 105, 53);
            ctx.fillStyle = colors.warning;
            ctx.fillRect(width - 120, 58, 12, 10);
            ctx.fillStyle = colors.text;
            ctx.fillText('Medium Risk', width - 105, 66);
            ctx.fillStyle = colors.accent;
            ctx.fillRect(width - 120, 71, 12, 10);
            ctx.fillStyle = colors.text;
            ctx.fillText('Low Risk', width - 105, 79);
            // Positive/negative impact legend
            ctx.fillStyle = colors.success;
            ctx.fillRect(width - 50, 45, 12, 10);
            ctx.fillStyle = colors.text;
            ctx.fillText('Positive', width - 35, 53);
            ctx.fillStyle = colors.danger;
            ctx.fillRect(width - 50, 58, 12, 10);
            ctx.fillStyle = colors.text;
            ctx.fillText('Negative', width - 35, 66);
            ctx.globalAlpha = 1;
        }

        // Huawei Mega Architecture Chart Function
        function renderHuaweiMegaArchitectureChart() {
            const canvas = document.getElementById('huaweiMegaArchitectureChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 600);
            const height = 320;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set styles
            const colors = {
                primary: '#1D428A',
                secondary: '#0077C0',
                accent: '#FFC72C',
                success: '#10B981',
                warning: '#F59E0B',
                text: '#FFFFFF',
                bg: 'rgba(255, 255, 255, 0.95)',
                grid: 'rgba(0, 0, 0, 0.1)'
            };

            // Background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Draw three-layer architecture
            const layers = [
                {
                    name: 'Cloud Management Platform',
                    y: 50,
                    color: colors.primary,
                    components: ['Operation System', 'Data Analytics', 'Customer Service', 'Monitoring System', 'AI Smart Scheduling']
                },
                {
                    name: 'Station Management System',
                    y: 120,
                    color: colors.secondary,
                    components: ['Power Distribution', 'Environment Monitoring', 'Safety Protection', 'Billing System']
                },
                {
                    name: 'Charging Equipment Layer',
                    y: 190,
                    color: colors.accent,
                    components: ['600kW LC Charger', 'Megawatt Module', 'Energy Storage', 'PV System', 'Smart Distribution', 'Huawei Mega Tech']
                }
            ];

            const componentWidth = Math.min(100, (width - 100) / 6);

            layers.forEach((layer, index) => {
                // Draw layer title background
                ctx.fillStyle = layer.color;
                ctx.fillRect(30, layer.y - 15, width - 60, 30);

                // Draw layer title
                ctx.fillStyle = colors.text;
                ctx.font = 'bold 13px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(layer.name, width / 2, layer.y + 5);

                // Draw components
                ctx.font = '10px Arial';
                layer.components.forEach((component, compIndex) => {
                    const compX = 40 + compIndex * (componentWidth + 8);
                    const compY = layer.y + 25;

                    // Component background
                    ctx.fillStyle = 'rgba(255, 255, 255, 0.8)';
                    ctx.fillRect(compX, compY, componentWidth, 18);

                    // Component border
                    ctx.strokeStyle = layer.color;
                    ctx.lineWidth = 1;
                    ctx.strokeRect(compX, compY, componentWidth, 18);

                    // Component text
                    ctx.fillStyle = '#333';
                    ctx.textAlign = 'center';
                    ctx.textBaseline = 'middle';

                    // Auto-adjust font size
                    let fontSize = 10;
                    ctx.font = `${fontSize}px Arial`;
                    const textWidth = ctx.measureText(component).width;

                    if (textWidth > componentWidth - 6) {
                        fontSize = Math.max(8, fontSize - 1);
                        ctx.font = `${fontSize}px Arial`;
                    }

                    ctx.fillText(component, compX + componentWidth / 2, compY + 9);
                });

                // Draw connection lines and arrows
                if (index < layers.length - 1) {
                    ctx.strokeStyle = colors.grid;
                    ctx.lineWidth = 2;

                    // Multiple connection lines
                    for (let i = 0; i < Math.min(4, layer.components.length); i++) {
                        const startX = 40 + i * (componentWidth + 8) + componentWidth / 2;
                        const startY = layer.y + 25 + 18;
                        const endY = layers[index + 1].y - 15;

                        ctx.beginPath();
                        ctx.moveTo(startX, startY);
                        ctx.lineTo(startX, endY);
                        ctx.stroke();

                        // Arrow
                        ctx.beginPath();
                        ctx.moveTo(startX - 3, endY - 5);
                        ctx.lineTo(startX, endY);
                        ctx.lineTo(startX + 3, endY - 5);
                        ctx.stroke();
                    }
                }
            });

            // Add data flow indicator
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 3]);
            ctx.beginPath();
            ctx.moveTo(35, 40);
            ctx.lineTo(35, height - 30);
            ctx.stroke();
            ctx.setLineDash([]);

            // Draw downward arrow
            ctx.strokeStyle = colors.success;
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.moveTo(35, height - 35);
            ctx.lineTo(30, height - 25);
            ctx.moveTo(35, height - 35);
            ctx.lineTo(40, height - 25);
            ctx.stroke();

            // Data flow text
            ctx.fillStyle = colors.success;
            ctx.font = 'bold 10px Arial';
            ctx.save();
            ctx.translate(25, height / 2);
            ctx.rotate(-Math.PI / 2);
            ctx.fillText('Data Flow', 0, 0);
            ctx.restore();

            // Add technical advantages
            ctx.fillStyle = '#333';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            const advantageY = height - 15;

            const advantages = [
                '• Exclusive 3-5 year megawatt technology leadership',
                '• Smooth upgrade from 600kW to megawatt',
                '• Full-stack liquid cooling efficiency +300%',
                '• 2-3 minute full charge experience'
            ];

            advantages.forEach((advantage, index) => {
                ctx.fillText(advantage, 20, advantageY - index * 12);
            });
        }

        // Power System Chart Function
        function renderPowerSystemChart() {
            const canvas = document.getElementById('powerSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500);
            const height = 260;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Title
            ctx.fillStyle = '#1D428A';
            ctx.fillRect(20, 15, width - 40, 30);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Intelligent Power Management System', width / 2, 35);

            // Power modules grid
            const moduleWidth = 70;
            const moduleHeight = 45;
            const spacing = 12;
            const startX = 40;
            const startY = 70;

            const modules = [
                { x: 0, y: 0, color: '#DC2626', label: 'AC/DC' },
                { x: 1, y: 0, color: '#059669', label: 'DC/DC' },
                { x: 2, y: 0, color: '#7C3AED', label: 'PFC' },
                { x: 3, y: 0, color: '#0891B2', label: 'Filter' },
                { x: 0, y: 1, color: '#EA580C', label: 'Module1' },
                { x: 1, y: 1, color: '#BE185D', label: 'Module2' },
                { x: 2, y: 1, color: '#0891B2', label: 'Module3' },
                { x: 3, y: 1, color: '#059669', label: 'Module4' }
            ];

            modules.forEach(module => {
                const x = startX + module.x * (moduleWidth + spacing);
                const y = startY + module.y * (moduleHeight + spacing);

                ctx.fillStyle = module.color;
                ctx.fillRect(x, y, moduleWidth, moduleHeight);

                ctx.fillStyle = '#FFFFFF';
                ctx.font = '10px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(module.label, x + moduleWidth / 2, y + moduleHeight / 2 + 3);
            });

            // Connection lines
            ctx.strokeStyle = '#6B7280';
            ctx.lineWidth = 1;
            for (let i = 0; i < 4; i++) {
                ctx.beginPath();
                ctx.moveTo(startX + i * (moduleWidth + spacing) + moduleWidth / 2, startY + moduleHeight);
                ctx.lineTo(startX + i * (moduleWidth + spacing) + moduleWidth / 2, startY + moduleHeight + spacing);
                ctx.stroke();
            }

            // Output bus
            ctx.fillStyle = '#1D428A';
            ctx.fillRect(startX, startY + 2 * (moduleHeight + spacing), width - 80, 22);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '11px Arial';
            ctx.fillText('600kW DC Output Bus', width / 2, startY + 2 * (moduleHeight + spacing) + 15);

            // Specifications
            ctx.fillStyle = '#1D428A';
            ctx.font = '9px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('• Total Power: 600kW', 15, height - 50);
            ctx.fillText('• Efficiency: > 96%', 15, height - 38);
            ctx.fillText('• Redundancy: N+1', 15, height - 26);
            ctx.fillText('• Response Time: < 100ms', 15, height - 14);
        }

        // Cooling System Chart Function
        function renderCoolingSystemChart() {
            const canvas = document.getElementById('coolingSystemChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500);
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Title
            ctx.fillStyle = '#0891B2';
            ctx.fillRect(25, 15, width - 50, 30);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Intelligent Liquid Cooling System', width / 2, 35);

            // Cooling circuit diagram
            const centerX = width / 2;
            const centerY = height / 2 - 10;

            // Main cooling loop
            ctx.strokeStyle = '#0891B2';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(centerX, centerY, 55, 0, 2 * Math.PI);
            ctx.stroke();

            // Components
            // Pump
            ctx.fillStyle = '#DC2626';
            ctx.fillRect(centerX - 70, centerY - 12, 28, 24);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '9px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Pump', centerX - 56, centerY + 3);

            // Heat Exchanger
            ctx.fillStyle = '#059669';
            ctx.fillRect(centerX + 42, centerY - 12, 28, 24);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('H/X', centerX + 56, centerY + 3);

            // Radiator
            ctx.fillStyle = '#7C3AED';
            ctx.fillRect(centerX - 12, centerY + 70, 24, 20);
            ctx.fillStyle = '#FFFFFF';
            ctx.fillText('Rad', centerX, centerY + 83);

            // Coolant flow lines
            ctx.strokeStyle = '#6B7280';
            ctx.lineWidth = 2;
            ctx.setLineDash([4, 2]);
            ctx.beginPath();
            ctx.moveTo(centerX - 42, centerY);
            ctx.lineTo(centerX - 12, centerY);
            ctx.lineTo(centerX, centerY + 70);
            ctx.lineTo(centerX + 42, centerY + 70);
            ctx.lineTo(centerX + 70, centerY);
            ctx.lineTo(centerX + 42, centerY);
            ctx.stroke();
            ctx.setLineDash([]);

            // Temperature indicators
            ctx.fillStyle = '#1D428A';
            ctx.font = '10px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Inlet: 25°C', 15, height - 45);
            ctx.fillText('Outlet: 35°C', 15, height - 32);
            ctx.fillText('ΔT: 10°C', 15, height - 19);

            ctx.textAlign = 'right';
            ctx.fillText('Flow: 50L/min', width - 15, height - 45);
            ctx.fillText('Pressure: 2.5bar', width - 15, height - 32);
            ctx.fillText('Coolant: 40% Glycol', width - 15, height - 19);
        }

        // Station Layout Chart Function
        function renderStationLayoutChart() {
            const canvas = document.getElementById('stationLayoutChart');
            if (!canvas) return;

            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const container = canvas.parentElement;
            const width = Math.min(container.offsetWidth - 40, 500);
            const height = 280;
            canvas.width = width;
            canvas.height = height;

            // Clear canvas
            ctx.clearRect(0, 0, width, height);

            // Set background - White for all charts
            ctx.fillStyle = '#FFFFFF';
            ctx.fillRect(0, 0, width, height);

            // Title
            ctx.fillStyle = '#1D428A';
            ctx.fillRect(20, 10, width - 40, 25);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = 'bold 13px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Ultra-Fast Charging Station Layout', width / 2, 27);

            // Station perimeter
            ctx.strokeStyle = '#374151';
            ctx.lineWidth = 2;
            ctx.strokeRect(35, 50, width - 70, height - 90);

            // Charging positions
            const spotWidth = 40;
            const spotHeight = 60;
            const spots = [
                { x: 50, y: 65, type: '600kW' },
                { x: 100, y: 65, type: '600kW' },
                { x: 150, y: 65, type: '600kW' },
                { x: 200, y: 65, type: '600kW' },
                { x: 50, y: 140, type: '600kW' },
                { x: 100, y: 140, type: '600kW' },
                { x: 150, y: 140, type: '600kW' },
                { x: 200, y: 140, type: '600kW' }
            ];

            spots.forEach((spot, index) => {
                // Charging spot
                ctx.fillStyle = '#DC2626';
                ctx.fillRect(spot.x, spot.y, spotWidth, spotHeight);

                // Label
                ctx.fillStyle = '#FFFFFF';
                ctx.font = '8px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(spot.type, spot.x + spotWidth / 2, spot.y + spotHeight / 2 - 5);

                // Spot number
                ctx.fillText(`${index + 1}`, spot.x + spotWidth / 2, spot.y + spotHeight / 2 + 5);
            });

            // Drive lanes
            ctx.fillStyle = '#E5E7EB';
            ctx.fillRect(45, 130, 200, 8);
            ctx.fillRect(45, 205, 200, 8);

            ctx.fillStyle = '#374151';
            ctx.font = '9px Arial';
            ctx.textAlign = 'center';
            ctx.fillText('Drive Lane', width / 2, 137);
            ctx.fillText('Exit Lane', width / 2, 212);

            // Equipment area
            ctx.fillStyle = '#059669';
            ctx.fillRect(width - 110, 65, 60, 100);
            ctx.fillStyle = '#FFFFFF';
            ctx.font = '9px Arial';
            ctx.fillText('Power', width - 80, 95);
            ctx.fillText('Module', width - 80, 110);
            ctx.fillText('Cooling', width - 80, 125);
            ctx.fillText('System', width - 80, 140);

            // Legend
            ctx.fillStyle = '#1D428A';
            ctx.font = '9px Arial';
            ctx.textAlign = 'left';
            ctx.fillText('Area: 500m²', 35, height - 35);
            ctx.fillText('Spots: 8', 35, height - 22);
            ctx.fillText('Rate: 95%', 35, height - 9);

            ctx.textAlign = 'right';
            ctx.fillText('Power: 2.4MW', width - 35, height - 35);
            ctx.fillText('Parking: 12', width - 35, height - 22);
            ctx.fillText('5G + WiFi', width - 35, height - 9);
        }

        // Initialize charts when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Business Plan loaded successfully');
            console.log('Initializing charts...');

            // Initialize all charts
            console.log('Starting chart initialization...');
            renderInvestorMarketGrowthChart();
            renderInvestmentReturnDashboard();
            console.log('About to render Monte Carlo...');
            renderMonteCarloSimulationChart();
            console.log('Monte Carlo rendered.');
            renderHuaweiMegaArchitectureChart();
            renderPowerSystemChart();
            renderCoolingSystemChart();
            renderStationLayoutChart();
            renderInvestorCashFlowChart();
            renderInvestorROIChart();
            renderRiskSensitivityChart();
            console.log('All charts initialized.');

            // Handle window resize
            window.addEventListener('resize', function() {
                renderInvestorMarketGrowthChart();
                renderInvestmentReturnDashboard();
                renderMonteCarloSimulationChart();
                renderHuaweiMegaArchitectureChart();
                renderPowerSystemChart();
                renderCoolingSystemChart();
                renderStationLayoutChart();
                renderInvestorCashFlowChart();
                renderInvestorROIChart();
                renderRiskSensitivityChart();
            });
        });
    </script>
</body>
</html>
